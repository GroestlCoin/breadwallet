//
//  BRPeerManager.m
//  BreadWallet
//
//  Created by Aaron Voisine on 10/6/13.
//  Copyright (c) 2013 Aaron Voisine <voisine@gmail.com>
//
//  Permission is hereby granted, free of charge, to any person obtaining a copy
//  of this software and associated documentation files (the "Software"), to deal
//  in the Software without restriction, including without limitation the rights
//  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
//  copies of the Software, and to permit persons to whom the Software is
//  furnished to do so, subject to the following conditions:
//
//  The above copyright notice and this permission notice shall be included in
//  all copies or substantial portions of the Software.
//
//  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
//  THE SOFTWARE.

#import "BRPeerManager.h"
#import "BRPeer.h"
#import "BRPeerEntity.h"
#import "BRBloomFilter.h"
#import "BRKeySequence.h"
#import "BRTransaction.h"
#import "BRTransactionEntity.h"
#import "BRMerkleBlock.h"
#import "BRMerkleBlockEntity.h"
#import "BRWalletManager.h"
#import "NSString+Bitcoin.h"
#import "NSData+Bitcoin.h"
#import "NSManagedObject+Sugar.h"
#import "BREventManager.h"
#import "breadwallet-Swift.h"
#import <netdb.h>

#if ! PEER_LOGGING
#define NSLog(...)
#endif

#define FIXED_PEERS          @"FixedPeers"
#define PROTOCOL_TIMEOUT     20.0
#define MAX_CONNECT_FAILURES 20 // notify user of network problems after this many connect failures in a row
#define CHECKPOINT_COUNT     (sizeof(checkpoint_array)/sizeof(*checkpoint_array))
#define GENESIS_BLOCK_HASH   (*(UInt256 *)@(checkpoint_array[0].hash).hexToData.reverse.bytes)
#define SYNC_STARTHEIGHT_KEY @"SYNC_STARTHEIGHT"

#if GROESTLCOIN_TESTNET

static const struct { uint32_t height; const char *hash; uint32_t timestamp; uint32_t target; } checkpoint_array[] = {

};

static const char *dns_seeds[] = {
    "testnet1.groestlcoin.org.", "testnet2.groestlcoin.org."
};

#else // main net

// blockchain checkpoints - these are also used as starting points for partial chain downloads, so they need to be at
// difficulty transition boundaries in order to verify the block difficulty at the immediately following transition
static const struct { uint32_t height; const char *hash; uint32_t timestamp; uint32_t target; } checkpoint_array[] = {
        { 2016, "00000000022f827cfb0fd67d5ae0f42d757a48cea496017cd52aaf39d6764025", 1395633136, 0x011e0000u },
        { 4032, "0000000001772ac01301089da772e6ea8ab7500c0db063519cb22c18fba977ad", 1395754066, 0x01460000u },
        { 6048, "000000000112a674d071a0d85fedfaba9a9844b3beb48cf7a2d5e9f7283957d3", 1395875402, 0x01430000u },
        { 8064, "0000000001a96b8e05de84452487d4052fe4e0697cc3eb6bce50287cf8717097", 1395996464, 0x02009100u },
        { 10080, "00000000015130d0bdd7a3346a1d351a261df662101d3665fb1d1046075e517d", 1396117729, 0x016c0000u },
        { 12096, "0000000001918fbd7edfa1f2a10d4d8c389546b4491828485c66b156d3c6d7c5", 1396238901, 0x01460000u },
        { 14112, "00000000005d8b7c9be297363ae5a00dab4dc236dd0378681f52a361351e855e", 1396359283, 0x01610000u },
        { 16128, "00000000006d04174fab0f49125562d7db1e68aa85016e2a7e75990abf4e76ae", 1396480059, 0x01560000u },
        { 18144, "0000000000fb7dede5e8b946bc721518bcc956971b53caf635eb31b6cae7c48a", 1396599694, 0x01610000u },
        { 20160, "00000000021334f6883b834ad4969ecddce33b8ae83f4545bb927e172b246577", 1396718053, 0x014d0000u },
        { 22176, "0000000000e4657a83c58a209b275b93e98d5a5eee05ca2667f057b17aee3766", 1396836427, 0x02008800u },
        { 24192, "0000000002352f04740cd406cc80f69ae26b896f4fc8c45723faafded6dacef2", 1396955662, 0x01320000u },
        { 26208, "0000000000945a5e87a84963b64031b388b7719cd1737baf48af41ebcfab4841", 1397073579, 0x02008600u },
        { 28224, "000000000034a1c782bbff1c2375bb84c23f818ae4b9f28ae5565fe7e5ffec0e", 1397189988, 0x02011c00u },
        { 30240, "00000000001188bb4e0936915b618a88653e63193b91b819c7ae6f14f81d95f9", 1397306935, 0x0200b000u },
        { 32256, "00000000004f6460d78fbf3fa3f22d2042c704a796885af0259b75b5a346bd2e", 1397423622, 0x0200db00u },
        { 34272, "000000000013199619f4cfe6360dc425582569d4166db83c433dda75c800bfb1", 1397538344, 0x0200cf00u },
        { 36288, "00000000014948481cf8671ec8dee86a0bdf8b7856b7702041233db612986988", 1397650869, 0x02009a00u },
        { 38304, "0000000000b9f1a19ce276515cac9e1ce07c75656013ca2af904de3dbcfe707d", 1397763323, 0x02009600u },
        { 40320, "0000000000767fa13decb77c468385423a260f38a6156000f16b17aea32a8a6d", 1397875997, 0x02010500u },
        { 42336, "0000000000560db946cbd1479a79dd4fdf18371c702d9f6215dd8541ca68c877", 1397987128, 0x01530000u },
        { 44352, "0000000003630cedb0d5b9f30e719401d16e41af600a64966c8b2994d215a5a8", 1398095749, 0x01460000u },
        { 46368, "00000000017aee1bc756daf199e3c6db3de5d930be74f39fcc0bb5476694d5d7", 1398201579, 0x014a0000u },
        { 48384, "000000000191eb396cca5633e54d7a24e74085d6cc7056096a2e3bdf5479f267", 1398306191, 0x01550000u },
        { 50400, "000000000070038037f3a02a2057cdfab10d33922050c21337927d9d4abc8d24", 1398405939, 0x01690000u },
        { 52416, "0000000001e4da1cabce301da6967a0ac6a1249b73b800436d0a40b918808a74", 1398508405, 0x016c0000u },
        { 54432, "00000000015eeb19c858a4da8eebf02c18c72ce6d850f6ddf6191f808417d176", 1398611068, 0x0200b800u },
        { 56448, "0000000001969e6195f14d700df7543f968964896bc3a0c7b59e4c8a9e80907e", 1398714770, 0x01770000u },
        { 58464, "0000000001ca9c1281535ffc4c70be9d6e5bee3622004349328303ce281b6104", 1398823076, 0x02008b00u },
        { 60480, "00000000007009d84594d93c3a3384202417a87fcf3f93ca9e9b697c0a285ebe", 1398937697, 0x0200f600u },
        { 62496, "000000000099c1e6aff921a846e5c9cede513076d919c3c588c652f28a0f218a", 1399048497, 0x02015000u },
        { 64512, "00000000001dcd88c7bb0c4e22beab29e1b87925b3dca7032659547c0e405cc2", 1399147556, 0x0200f000u },
        { 66528, "00000000013a3abacea28a5ba3db8acb55f5ba59f81d75624abd80d0701acdd5", 1399235593, 0x02008400u },
        { 68544, "000000000164c03c365b254d5b728b677604802132d917b7845ba0dc2b15315e", 1399321097, 0x02008f00u },
        { 70560, "00000000006e1ab60a5c5b755a3063605965dad2a70d3bb114a7e7b8b05a9502", 1399410080, 0x0200cb00u },
        { 72576, "0000000000b028094e1a41963e6b06395daa651738df72c59c89d23a98fa7ade", 1399496886, 0x02013800u },
        { 74592, "0000000000eb8983987b9485050b7e2e06e3e7c1677c8ee19cc4507e72d8848a", 1399568004, 0x01600000u },
        { 76608, "0000000000dd6af67db229d89edb0d45ceecfda2bfda577148c0a5132be4696b", 1399614952, 0x017d0000u },
        { 78624, "0000000002169c8fefe25c91f8c8d2d11c7b5918bb447641b2ae89455574ff72", 1399663010, 0x014b0000u },
        { 80640, "0000000001e7e6feb002fd6db9388579036789861aff96b5e294f7a9a36fcd14", 1399707652, 0x01620000u },
        { 82656, "0000000001dc70ff5cb69f119e63e6dcdf7211804b5c14c28ffd254f6bb77ef3", 1399742267, 0x015c0000u },
        { 84672, "0000000000987f3e7674541514932754f262a3e8d6eaefefbc3af4a9809269d9", 1399778259, 0x01670000u },
        { 86688, "00000000014f0dfcc8fa842503e889894cc4266dde357beaac54e612f64d93ad", 1399830406, 0x0200aa00u },
        { 88704, "0000000000817f23861e3ed1f7b3aebe82ae22cd49155484a41595f40b2fe2b9", 1399934192, 0x0200ef00u },
        { 90720, "0000000000f00acc34243782228f38d9c0ceb12a42dca3ba7dd2c05675656c22", 1400053178, 0x0200e500u },
        { 92736, "0000000000582a8ef7774bc775e76eef2e837afa34ba4129ae2998506656673f", 1400172682, 0x01720000u },
        { 94752, "0000000000046c992238d03341790cce93d3af8465602f9a4ea362b3df4ef221", 1400293522, 0x02008c00u },
        { 96768, "0000000001510b3f805d0eae14277439444bc34505ea354bc22e82756964b825", 1400412229, 0x02009c00u },
        { 98784, "00000000021ec1d8488fbaf8691969c1d32c458f50fcafee9e1e9ad0b80b2150", 1400532960, 0x01740000u },
        { 100800, "0000000001c27d92fa1a3d1912b7caf3b398cfab5aa3d18cd21442bebdfb119a", 1400649214, 0x02008300u },
        { 102816, "0000000001f601ece9ea73ef9d5d82f46d56db464dc80547cb34c43fa484d6ac", 1400776738, 0x02008000u },
        { 104832, "0000000002433a6769e3104a12158a55756e01fa4371aa771f2da7f9638e4446", 1400904012, 0x01670000u },
        { 106848, "0000000001fd1f3a77bf9e524171ce9de9363af2008c12876255712c337b22f1", 1401031328, 0x01680000u },
        { 108864, "00000000004160b657766ef75f16e3280dd470d560ed15dec8ca967734909813", 1401158425, 0x02009300u },
        { 110880, "0000000000f1e31f822e5fa575c5c70dc6d9a1e579e8e37d7a83519c18744c7c", 1401285437, 0x017c0000u },
        { 112896, "0000000001530405ac65bb337b60a77b27a01ad5b98134a133bcd3f4b2bc247f", 1401412579, 0x01700000u },
        { 114912, "000000000130e8682d9cb8f3a1b6520e2c3a493dd9c4d782f04433a7e6e7867b", 1401539422, 0x02009d00u },
        { 116928, "00000000006f808162824ed8f43b83802e7f140ea14348066f4da3a9cf05e46d", 1401666086, 0x0200ff00u },
        { 118944, "0000000001ba7a392d58177afd7a2cf07318b54351ac2bf830756f99710720ca", 1401793762, 0x02008000u },
        { 120960, "0000000001d7db2f318c594eb085ee99470b8617abc132f0f10f4bd65bce0a3d", 1401920577, 0x02008100u },
        { 122976, "00000000007fa97547bdb0bda2601818040499ee91a505f443879fffcbff13b0", 1402047818, 0x01670000u },
        { 124992, "00000000013d811bcdf9e1af937d80ccbd9d5694f3f489ae7079b209b648251b", 1402174913, 0x02009100u },
        { 127008, "00000000007e29a873be8f97457f97b47e0f515b3bf1e3aa598ad545af964d59", 1402302533, 0x015e0000u },
        { 129024, "0000000001b2c243c54ba369856d055370a608008781d4844d6f396ad3de552b", 1402429877, 0x01640000u },
        { 131040, "0000000003261de03df37a7c795ee3eb8ffb5eaced78bc0cc4513ab825fba867", 1402557079, 0x01440000u },
        { 133056, "0000000003006857cb197c3f41960030d80b4fde5ce1826c5ad367e42aadd054", 1402684200, 0x014f0000u },
        { 135072, "000000000181264acbd859ea6f09ac5075bac1c5abff8864adbe2b37a8d2f35a", 1402810839, 0x0200a400u },
        { 137088, "00000000025e53fe788f84d7b5c155b2dcb367029174ba092d6a2cb313966ccc", 1402938416, 0x016a0000u },
        { 139104, "0000000000cb553cc22128aca1eb3a4d9dfd8a8c964cd21315b23149e9af1d71", 1403065446, 0x015d0000u },
        { 141120, "000000000246e60ae5d74939a6da26b28a6c88831ff7421368c96d3e1327372c", 1403192770, 0x01480000u },
        { 143136, "00000000026bc4b1d3ad19e50022469fea0da90ffe1af5f2597105d6f67f92ce", 1403320170, 0x01420000u },
        { 145152, "0000000000a22d1705649229a8956d5bb5398b9779b2d287aef097145a2143a9", 1403447143, 0x01410000u },
        { 147168, "0000000005b1af26791b0174a2bc2142577b7cb535fce9801bd169753a87bc94", 1403574774, 0x01260000u },
        { 149184, "0000000005e9fc2235014f415d42ad32ebed8ced22fd63b20957a3e5d9d9bb1b", 1403701988, 0x01280000u },
        { 151200, "0000000003194c4316b0a5ff88d1e60dbcef5f23b2ba9129ea5b2b37c04ea5dd", 1403828833, 0x012c0000u },
        { 153216, "00000000045d0dee91af5c2874b9337c6d704914a7ddf4fa2fc45852599d5f16", 1403956013, 0x01340000u },
        { 155232, "0000000000fe5649852fa121e09e22aeec21c5ef80afca4bfac78fbcb6795e04", 1404082939, 0x01480000u },
        { 157248, "000000000599637e8cab6926edaaefcca7eeb0ff00738801c2780769a15136b8", 1404210698, 0x011e0000u },
        { 159264, "000000000030f9e8784f63d8d56b07abeff6e59c8bb9b794db6723c31e7830bf", 1404337767, 0x01300000u },
        { 161280, "000000000289f3f995327efc116a60fa60aad5cb4406262cdc4d5caf5339f620", 1404464778, 0x01380000u },
        { 163296, "0000000006a7bf93299effedca181bd91eda82ba6579ba8c1e39607b8628a622", 1404592346, 0x011b0000u },
        { 165312, "0000000001c0f67d992a751574b32007bdf8110c3835f6429a43ecb77bffe750", 1404719367, 0x01270000u },
        { 167328, "00000000051323b3757df98ae6a0fa2c7c52811f84843b61618daea8b243955b", 1404846629, 0x011a0000u },
        { 169344, "00000000014799b5ec2aa44b78d903507326c6fe55ab1f5f8342d1a21b25e809", 1404973315, 0x01270000u },
        { 171360, "0000000009e25fabd5e465a3d96cead2a3cfdfa08b087d3d56de94866032a8f3", 1405101058, 0x01170000u },
        { 173376, "0000000000bd5776a6383992d4cd13ce87e925c298d292f13fb821b0a8b2579b", 1405227944, 0x01260000u },
        { 175392, "0000000000539c0b4680931994b973f9be59024c91cb0be3b2ca1eb1832fd746", 1405355209, 0x011a0000u },
        { 177408, "0000000000be1dbc448f5be16a256b4f6531b876a9c67b6381ffd58bb2d967da", 1405482140, 0x01190000u },
        { 179424, "000000000634739cc3e522f68553f7167e50d6416f47ddf23cb09817eab3a09f", 1405609575, 0x01160000u },
        { 181440, "0000000006c48af0b605029fce970f1e6621b25459998fcb532b6c8cdac0d000", 1405736570, 0x01150000u },
        { 183456, "000000000028c62e077f3adc18a47cdaff5fb25ad1fe3ab62333484beebc27ff", 1405863731, 0x011a0000u },
        { 185472, "0000000009458120d711bef78c05682e978f5265193c6a8bea20b56c832f76e5", 1405991113, 0x01160000u },
        { 187488, "00000000006caea9a91e002e87d7c6797072a2013f49d62bcaf980766f3f6cdf", 1406117961, 0x01130000u },
        { 189504, "0000000001275d7fc1817e2cd5c0c029b100c683c9ffb43eb8af9a1c3eaeda58", 1406244876, 0x011e0000u },
        { 191520, "0000000001cf5f0120f5ad420eef9253679fa6aeea6ae4d81132a7122e6532ec", 1406372164, 0x01170000u },
        { 193536, "00000000036521cc1c36eb112e157a6f2556902303a882be06be374381d8b5bc", 1406499142, 0x01110000u },
        { 195552, "0000000000693a72d19da7ab28be93c95cf832e3be9dc5e43ecfa78f712af537", 1406626310, 0x01120000u },
        { 197568, "000000000963f448fb19060670b7b2ffa043f2e2e8c46e0be664bdb69deada40", 1406753579, 0x01100000u },
        { 199584, "0000000003054ee610ac494c6fdd39b1696933b5e271b16af8b6c4d451d78273", 1406879981, 0x01270000u },
        { 201600, "000000000022f0e174efd1284206168fd32f607525d95dc44b4db15b6860b5dc", 1407007210, 0x011c0000u },
        { 203616, "000000000275820cae243a2b1f8abd0471d206e112f0cecb08ccefae2338bef2", 1407134796, 0x01150000u },
        { 205632, "0000000004ee49e6e85b011db83bf3f2f757c8425a93009b5e14caabd00510b6", 1407261813, 0x011a0000u },
        { 207648, "000000000344f6b90d306d6f2aa7c19bd26068cc9b224974cd35c028c89e0689", 1407388857, 0x01230000u },
        { 209664, "00000000046f2c13b753bc93d9e7b1975fdcd696c6964190995820af2fd3ef57", 1407516359, 0x01160000u },
        { 211680, "000000000263f46e8aef1d6d6786f099eb816eb79863590d86eb051a5705dad2", 1407643655, 0x011b0000u },
        { 213696, "0000000007bf084d19880aa61252ec90af02cc6e92c4cf7791c1df721b32b493", 1407770559, 0x01160000u },
        { 215712, "00000000065aad61cf20882b290c695112231bb812d5107bbe4bde3cd6039d4d", 1407897867, 0x011b0000u },
        { 217728, "000000000a0fd0d06b4f4e89cd1bfc476fb8858b8bbe6cdd496bf6d4cf61ca6f", 1408024865, 0x01170000u },
        { 219744, "000000000386ace50455ff268c949fc55ddd33e826e10120610918fd6cca88bc", 1408151956, 0x011b0000u },
        { 221760, "00000000086de4bfc643a826345c2ff7218c5210912eb6c767a9bcc875b71052", 1408279138, 0x011e0000u },
        { 223776, "000000000b8b7486edd9847a787e068da0a4a412ac25b323885f47a49bb5e070", 1408406714, 0x01150000u },
        { 225792, "00000000098dfccab37c182674ac112f974e9c36051affb45824b563efbb25ac", 1408533827, 0x01180000u },
        { 227808, "0000000006d2f7aa488ef684b7850a1ce9bd357f176f7880b36604665cb9461f", 1408661071, 0x01130000u },
        { 229824, "00000000036a89b318dbde09155fde430e14b74484f7726096ac3bd10a3b7bd3", 1408788121, 0x01130000u },
        { 231840, "000000000e1ab9dcc9381546e6357bd412691d70f50bd14224cb6855b5d59ade", 1408915244, 0x01110000u },
        { 233856, "0000000002a544766b25b37ba5a17b04d3893a03b5e5777878f4423d2acb8341", 1409042728, 0x010c0000u },
        { 235872, "0000000006f566e6d40fcb4d0f3e232e1fed8a99a218c48c508f4fbd44e75d90", 1409169543, 0x01100000u },
        { 237888, "0000000003a2af7bc92477d235ac5617239d3e04b7e442dc8e202f8feca34730", 1409296681, 0x01120000u },
        { 239904, "0000000004d2808a205cdea73f80a08ade71347100cc0577739c05346995240c", 1409424083, 0x010e0000u },
        { 241920, "000000000af1634708c3f101dd3bec13443f372750e7f46f1aa163db3a255bd8", 1409551093, 0x010d0000u },
        { 243936, "0000000002507b2ada397a55c1fbbfed2e362b15a4cbf4f14ab88ce8250b13ae", 1409678359, 0x01100000u },
        { 245952, "000000000bdcf468cf635781e1f6fc90f113d49c2f3817b83aa2cf899c6c272f", 1409805918, 0x010c0000u },
        { 247968, "000000000e669298cdfedaa1aa022653b33c789999beba213ccfba4ae6848f81", 1409933206, 0x010b0000u },
        { 249984, "0000000007770c66bf0de7ea09bf7b6622980c572d8d799ac4032f7fef4b18dc", 1410060420, 0x010b0000u },
        { 252000, "0000000004f7d25c3737f98b6c33ae26709174c6bb53853826e7218a76793320", 1410187655, 0x010a0000u },
        { 254016, "000000001170873f63a9e922ed9b9fa8c467220b56aa73893f02a6e382fae503", 1410314428, 0x010c0000u },
        { 256032, "0000000008a5b26a8922969ebc5bc5d59c334794f1b7e50f13731e53bf69093c", 1410441938, 0x010f0000u },
        { 258048, "0000000008cb73b1d900f4e5798b9c1c50ff4e6ad03cae26a6d10a299c01637c", 1410568410, 0x01140000u },
        { 260064, "000000000340663443ad794a296f7a82d3d240e934509ddc03ab8b1ec8d0c118", 1410695486, 0x011b0000u },
        { 262080, "000000000613df294c332a10e9db8f1e563ee6aa930edc984557a7cbed862f57", 1410822787, 0x01130000u },
        { 264096, "000000000957c28eb557ed7f248ebfde2984d60fefcf240469ee36ff7dbf5098", 1410949714, 0x01190000u },
        { 266112, "000000000124629a271ac1927d26a38db33ec0b4da2046de8a036bd0933aaebc", 1411076631, 0x011e0000u },
        { 268128, "0000000008a4f777364a78c1e869c02f279e9492718bad31939db1f812b5141a", 1411204261, 0x01170000u },
        { 270144, "0000000003f31cf0ff1b0a93935f38324827ef63e97ead8bbaf8ae19f6e6a626", 1411331371, 0x011f0000u },
        { 272160, "000000000240fe561f88c7d0bf099c8dcb869b693075efb59325769791fc48db", 1411458757, 0x011d0000u },
        { 274176, "00000000021737f3f540c379f5e857eb54432fc83c9f2ead6789836ea920be0a", 1411586116, 0x01170000u },
        { 276192, "00000000049303a35ba58e8503e644a5d52d001d08a18f3bdb7466c1024ee8c5", 1411713520, 0x011b0000u },
        { 278208, "00000000040aa71dcdd7985277499578bdc27e27cf2fdc12e9d08b444af7550a", 1411840607, 0x01190000u },
        { 280224, "000000000aea12e575e5494330ee1db0eaef78cef1aac92d649d36bde50add55", 1411967766, 0x01140000u },
        { 282240, "00000000014c86f78b129ea3f6fde31e3be60e08976eecff1c37d3b37fcc667a", 1412095585, 0x010a0000u },
        { 284256, "00000000059ceb7b8d25ebdf452a85915aad973a8c069a3db596ef342a1904d3", 1412222537, 0x010c0000u },
        { 286272, "000000000082b36315166573afd131fb24d839dc035fa03753c36fbda733fa5f", 1412349635, 0x010c0000u },
        { 288288, "0000000004783f197fec2a9f844e5e0c70f1282c56b26cb5af1e3fad8edc48a9", 1412477049, 0x01070000u },
        { 290304, "0000000009983cd02aa043b0f68b88e56dfab96ae0f099257f092b30b106887e", 1412603754, 0x010f0000u },
        { 292320, "0000000006e0622bd7717e18833ae6f9a6ec8e387492217355da0c8f62eca4f7", 1412730771, 0x01110000u },
        { 294336, "0000000009a2392d64365c61896e7c1438c9a800eb46478c162b99d96ee2db56", 1412858027, 0x010e0000u },
        { 296352, "00000000096fec0deaff384cc1f78e9ac056cd24d352eb3dba3c97ac22a3016f", 1412985012, 0x010f0000u },
        { 298368, "00000000095e18ac30907a3af9fcb2152a277a294f1e70a42f29e76aa80011ed", 1413112401, 0x010a0000u },
        { 300384, "000000000f889db3ba8fbb4b7fccf7620af5acf9212d684a3a8bd9098494395f", 1413239612, 0x010e0000u },
        { 302400, "0000000008017e15beaf106ad3153fc087f049d3f770e3da7c38d31aca777dcd", 1413367184, 0x010b0000u },
        { 304416, "0000000003f9c6578fbdf3b1084a739afb8a5810e08cb7087ca91d43a7b0cc64", 1413494500, 0x010a0000u },
        { 306432, "000000000a6c561a1e5b279add6144eca39a5f111ebb809bb59ee98dbbc86d5b", 1413620951, 0x01110000u },
        { 308448, "0000000007380bf2ed157feac1e53df5dca89e172d292e7840d4f1dee1e9d6df", 1413748860, 0x010b0000u },
        { 310464, "000000000a36a58306b5405431ca4fa4abec93cbfd7ebe036bbeefbfafde6768", 1413875960, 0x01090000u },
        { 312480, "00000000033f23beca5f32a9df96e608f1f30148d9481ec23ec55ac8559b4919", 1414002703, 0x010c0000u },
        { 314496, "000000000aab96acbf337249e78aec2ac0117936c6999c30f0e5a7e54475ff15", 1414129869, 0x010c0000u },
        { 316512, "000000000fa6e70cf8ad5d23ef5a046af3d5f9f4113fa62913f5a0ccf1c980b5", 1414257299, 0x010a0000u },
        { 318528, "000000000de48ea8f14f489cbe96f8125ca88cfd7403e4d5ade1ee0daffffdcf", 1414384520, 0x010a0000u },
        { 320544, "000000000a4cbb66e4a77ec016523104db095ea5b325a8278c77c35ee190e28e", 1414511648, 0x010a0000u },
        { 322560, "0000000007fbe746252aee768f8e4d858fc34818f46a696385dbdfaea784df45", 1414639037, 0x010a0000u },
        { 324576, "000000000b8abea9316ad80f0badf4c325bffcbdb239392d2e2ae72398553bcd", 1414766168, 0x010a0000u },
        { 326592, "0000000007d46707028d83231143399b72b1724a52a4d328e02cbc3738870078", 1414893924, 0x01060000u },
        { 328608, "000000000f8ef14402a33711f2180dd55ff381baa7142f060ff9ac0bfa0785aa", 1415021019, 0x010b0000u },
        { 330624, "000000001f75b7c27b7d406307add19c6726859a080ec166e08be7cd349b8c4b", 1415148524, 0x01070000u },
        { 332640, "0000000006d0179896d0a743a93fd063d85ed013348fc23eadd5392fa511284e", 1415275759, 0x010b0000u },
        { 334656, "0000000011aadab6e8bd99c2f73e1585e6a0ec7334f4b3839d925b33c838c844", 1415403369, 0x01090000u },
        { 336672, "000000001498ed9ae361d32e7bc8f11e661f83beaa2b629ace38fef1e6548d9e", 1415530197, 0x01080000u },
        { 338688, "0000000005f3cce53e487a9a499483c8e8d6633bfa7e5b10d4c6d802e50cf354", 1415657500, 0x010c0000u },
        { 340704, "00000000193808c064649c29e8576bf1012a2a586f64183048067e27f648de99", 1415785028, 0x01080000u },
        { 342720, "00000000104c70677dc6249505b2e66c1d80ce2289e7f76015b61eaf30226975", 1415913369, 0x01070000u },
        { 344736, "000000001439f33d83f1f03a3d7535590dd34d5b3d00ac69991b19547ae3cb5e", 1416041193, 0x01080000u },
        { 346752, "0000000015379f47912519217724ea8c8348deb79e5b7990d8c847096518bc65", 1416169574, 0x010a0000u },
        { 348768, "000000000f8536eaddf3874691c55fbb8718da40fbbbd605c92bd395cac5d4be", 1416297686, 0x01060000u },
        { 350784, "0000000003d1fe08a211baba7b815ec2b9cf6dbd6f97d4b09e7e9e05336deb11", 1416425042, 0x01060000u },
        { 352800, "0000000016e4010a958e4346c456471e3120e76dc98e1e09fc2328c5ae37bd65", 1416552378, 0x01070000u },
        { 354816, "0000000006e55ec6e52636027e72ee119c857eb1b118332f5fd2edcb683c1271", 1416680258, 0x01090000u },
        { 356832, "000000000a574c4d31d0916a20ec12d4a6c3f1ac624fd2b517a8c8d1e5ba5991", 1416807472, 0x010a0000u },
        { 358848, "00000000007c4ad0ddc099e3c29d2365d1cb52b8bd52c22d7a4abeda56b2e15e", 1416934610, 0x010d0000u },
        { 360864, "000000001c0e05b23fa149768ecd168518132a4e4e99653074f789191077f843", 1417062410, 0x01040000u },
        { 362880, "0000000000470dcfb6b0296a3990aed7c3f276c0599ca2ae5ced26ceec156cb5", 1417189860, 0x01040000u },
        { 364896, "000000003101fec1e6a329ff3667ab25e109c9aaa406f6bc90fbb7e2f6e6035c", 1417316859, 0x01040000u },
        { 366912, "0000000007e51d2c0680120889c45e8b883ad3c2ea66ce12304b25ce3af1e1ef", 1417444085, 0x01040000u },
        { 368928, "0000000016e0c41e0d9fbe1907c41b366c079c03d9a3f6f7dec31f5a02fa3a38", 1417571473, 0x01040000u },
        { 370944, "000000000e05fabaffb61da2f333d39cabc885f894a8ad1ec71cb1c156074ad4", 1417698412, 0x01060000u },
        { 372960, "00000000262c01a4905838bb0d7023f6d444c82fecb9e9f19150d3ef03f0897c", 1417825582, 0x01060000u },
        { 374976, "0000000007107d8e5934cfb976eedc71958ccae875be82a7ad3503b5a460c6e3", 1417952318, 0x010a0000u },
        { 376992, "000000000951928f4c2b98c6f232a7b1080dd235e44598232964198ed0cd7eb2", 1418079378, 0x010b0000u },
        { 379008, "000000000392f04e0bb8ea9c31cd0805ceffea588638354c686f7265fae754bd", 1418206671, 0x01090000u },
        { 381024, "000000000157882dbb43515cb13c9fda7469019d8446548b545ff4a6505bb8e4", 1418334348, 0x01050000u },
        { 383040, "000000001a2896ac832076f1e3778c59aa3676111d0bdef0adf2bf600a9d4a8d", 1418461332, 0x01060000u },
        { 385056, "000000000e2f9a0f37388bcde06f604e71dd03174ee24b9e9a3bc2c227841947", 1418588306, 0x01080000u },
        { 387072, "0000000025d1dd677e722eb3ce6ee087cfbcbb03913a8fc7754eacef784c7acb", 1418715724, 0x01060000u },
        { 389088, "0000000002446300d878296d3e12bb9d3d434d683c5944982e966ac780e393cd", 1418842567, 0x01090000u },
        { 391104, "000000000cf823129aa8d39c744554cea0d3f954915f917bbb6018d721f6f360", 1418969937, 0x01090000u },
        { 393120, "000000000f775b1587c0ebd61e9f78e607da9de9c14b70cd6c92b244b13b888c", 1419097281, 0x01070000u },
        { 395136, "0000000010d3ec1817519f867880938b986bba368b40b367fad4eb5acbb1fdf6", 1419224906, 0x01070000u },
        { 397152, "0000000010fac8a00a288ca3c494e213264a0ec3e639efe0eac6f771f41609d9", 1419352893, 0x01050000u },
        { 399168, "0000000010e5222ab97bb83d905b93f1362e6750bef36fa8986cb3b39905dfe7", 1419479355, 0x01060000u },
        { 401184, "00000000123f7badd09a6e91627f8d008928faa460f60c111ae0e0b888a930fd", 1419606587, 0x01090000u },
        { 403200, "00000000009af4b38d179c51b28002bc9e448a426f17aa737cf615445f7d7247", 1419734182, 0x01060000u },
        { 405216, "000000002294b8ad89fedc5cd3ac90435bf08f4bfc871c3ead0c74508f9be170", 1419860880, 0x01060000u },
        { 407232, "00000000175ec3b3208aca2044e94c5e83976f9b3b04ffb75b425cf4b88c3a80", 1419988732, 0x01040000u },
        { 409248, "000000002690cc19dfcf50e0e7ad70c8137c44a677ef6a5caa4d6f19c426001b", 1420115420, 0x01060000u },
        { 411264, "000000001479765a4af33db02a430bb0fcce6405b8696ab1a94055a430e8f181", 1420243233, 0x01050000u },
        { 413280, "00000000170cdf113d79234433fe0f04060e6fe79d020b6bcf8dd503567a95ce", 1420369575, 0x01080000u },
        { 415296, "000000000e32723cb8e14ba982efda0ebd58fb3394da70e2a3e50af0caed3d3e", 1420497465, 0x01040000u },
        { 417312, "00000000083933c0fe9b0de804f2d9ab2b574110be4c52cbc34793697b42b23a", 1420624162, 0x01060000u },
        { 419328, "0000000013e2575fe89c726de6c30e33c469c8302a9e537d3a872cf6513b8e32", 1420751230, 0x010a0000u },
        { 421344, "0000000007342d8fe7426892c46dfc2c77d5650cbdafdc3f259ca362131b1072", 1420878374, 0x01080000u },
        { 423360, "0000000033e29dde910e35e2e30569baadaeb1e5ae984a4dae028c14ed8635b2", 1421006143, 0x01040000u },
        { 425376, "00000000243f5455673d06f9f913b5ac3a655bd4fa2302b5c84de2645e50631a", 1421133057, 0x01060000u },
        { 427392, "000000000bf179f0b4a3964a6cd40929ab7361be45ac5fbd8da0e294b89fa597", 1421260540, 0x01050000u },
        { 429408, "000000002511a6b41d2bdd3f329f37e9007303a87fd5df5132822ce1153eaef4", 1421387419, 0x01060000u },
        { 431424, "000000000e8f6f7fa54bf1310b8b668146fd8b0904882cc6078824452046910e", 1421514905, 0x01050000u },
        { 433440, "000000001b3e865f9e54d975422eb9b0da3e920cd9a49ff873ad9b6e499acdd2", 1421642341, 0x01050000u },
        { 435456, "0000000016bff18744e15ab52ba8f8c963044ef1a8a421c005ce6bd2db59ec62", 1421769161, 0x01080000u },
        { 437472, "0000000028e810dde762f40c0785a8cbb3c19ea247d3c966001286a0608affab", 1421897338, 0x01050000u },
        { 439488, "00000000220ab3134067f2a0c388f701642332d75a72f855f50f74aab2b5ff19", 1422024799, 0x01070000u },
        { 441504, "0000000013eed8f012b8f4988148dee0372d1ed54aae9d6cd5bbe21bbdb8dd8e", 1422152874, 0x01060000u },
        { 443520, "000000001dc9f889828d651ea375e997e574b2fc39d4d4011395d39acc71f27c", 1422280422, 0x01070000u },
        { 445536, "0000000019aa36c55484d52291271319e5717c94b233610c8819168e88b9d66d", 1422407946, 0x01090000u },
        { 447552, "000000002ff22003584bd18843e298dcd46c4e09538890169f41a696eadb847c", 1422535752, 0x01050000u },
        { 449568, "00000000109213cd372a59edf09ebd020c3d21015d850ea1ab93c6ce80342075", 1422663010, 0x01090000u },
        { 451584, "000000002ec7b1b8446eab2bf1ea7be8d9d6938374a2d9fde966b2ce6fa37095", 1422791957, 0x01050000u },
        { 453600, "000000001e6dcceb7f47f58a7d785d85b6fc5469ea291185f141b85ea05531ba", 1422919349, 0x01070000u },
        { 455616, "0000000004723d80d45d7ee04ae458c14c381a3cdf1c20c928ac1b365933aab4", 1423046857, 0x01080000u },
        { 457632, "00000000086d36746199de8929c9d6092764c8c59309b3d68317534f82ae77e4", 1423173868, 0x01070000u },
        { 459648, "000000000f8d6a571d74c788cd42459e2569f2d98f1e64d1b109fff45901f844", 1423300892, 0x01070000u },
        { 461664, "00000000038331f12d56c0f30b5777a5aa1621234ea65f59a5171e0bf3b55133", 1423427939, 0x01080000u },
        { 463680, "00000000138ae5e0659af0016e25c63ff87ac48416244ec618f5e4cc2d83136d", 1423554981, 0x01080000u },
        { 465696, "00000000143cc1dde3f699be3f847f7cf972ef37c20dc3e96b9315693927616f", 1423682517, 0x01070000u },
        { 467712, "000000002b4652102a4e4eb5b874950bf186e008d7307efc5f1e0f85002c146d", 1423809594, 0x01050000u },
        { 469728, "000000000f85e45235d8545f7df3c5bb57609837243e76180cae1397277fd074", 1423936871, 0x01060000u },
        { 471744, "000000000b87d77b9c45d5c25aa7ba947dff1cbc5c2dc600dcca9107adcc2b54", 1424064390, 0x01080000u },
        { 473760, "0000000009b3a015eb2060da32b6df58845ec90ae32a59d5d45e4a0f7e1ced99", 1424191144, 0x010b0000u },
        { 475776, "000000000e1ef28577c2621165edb5968e07f198d3f0cd5de25fabf723c86649", 1424318118, 0x01110000u },
        { 477792, "00000000179d05a12e576e6961bd94b38fd594231a880a85fe7b25f6b716c40f", 1424445401, 0x010a0000u },
        { 479808, "0000000003275633306e4482febfe347fc31e5090363b95539f15d5378842252", 1424572165, 0x011b0000u },
        { 481824, "0000000019972e461d5c8d1c60108bcb299d274ade2be8194e0f0da6b16c7ead", 1424700607, 0x01070000u },
        { 483840, "0000000008c48153501b3c56cee109a66e14da3448ad424b5da1475a3e814cc5", 1424826962, 0x010f0000u },
        { 485856, "0000000009f4394196f3c43d472a0fbf3625b51a7a8aba5f2e64206814abe19d", 1424955494, 0x01070000u },
        { 487872, "00000000034110ec6e3b8f70cf0e23be0d25196cba7743cd4317869c0d628fb8", 1425082317, 0x010c0000u },
        { 489888, "0000000016b37f119ce12a4873a7c2b847fc4d920b5b2c284ad53db774397cd2", 1425209735, 0x01080000u },
        { 491904, "000000000e86d9f639c2c46fcdb32f1d7535678a0b054e79c54270c36c2685e3", 1425336592, 0x010c0000u },
        { 493920, "000000000f2f7ce7d88a03372d7a53c692cedf416451463f3821a3bbeb65908a", 1425464513, 0x01070000u },
        { 495936, "0000000001a1e78217c3b127e64d7d44efdd4c27c8b302f12d6ed2583709a44f", 1425592079, 0x01070000u },
        { 497952, "000000001e9928e74e5cd647b3c3d18e4940e0fea475b3905a3f5ae399a4d2b7", 1425719831, 0x01040000u },
        { 499968, "000000000eccef74f8820f3fb1c68d0223929515e6737861dd7fa57892e29ac0", 1425847568, 0x01050000u },
        { 501984, "0000000016b75a7c83b1166cb012574a8ab6e194234694b8bb7f513d65054240", 1425974989, 0x01050000u },
        { 504000, "000000000333b5885f24f0c763c8c02c17b7e0b3b3fa3a9e75e49f661a10ef07", 1426102289, 0x01080000u },
        { 506016, "00000000154051231ee7bacf0fbc530001be8677d84c4f8f1fec67043bf58c2b", 1426229568, 0x01070000u },
        { 508032, "00000000036f5373c2f5f822a5e433faebb895cbda263d6f73859533362752b8", 1426356255, 0x010a0000u },
        { 510048, "000000001eaad4b1dbb967d222a43f09cab7e38d95ddadc66f27785f5a69782f", 1426484086, 0x01070000u },
        { 512064, "000000000bf1abb10d593923f8dae66f39496ce8130ddc531efdc86b2d00d7c7", 1426611016, 0x010b0000u },
        { 514080, "000000001ab2e972cb8137afb1de54ccc79786f34f207e5a980592f4fe7e4409", 1426738964, 0x01070000u },
        { 516096, "0000000011c3668422f634dbce91f1957b01912ddcbadbfea81d178da71356b1", 1426865704, 0x010a0000u },
        { 518112, "0000000001ddc3fdf8d08ceced7562ba2cc4470dfb52b163771140cc33ab7ef8", 1426993430, 0x01060000u },
        { 520128, "0000000002671cf8cf511ac0c78368af60b9634c63c3c90d739a9fee8012e05f", 1427121095, 0x010d0000u },
        { 522144, "0000000000f88fbc8a6ec8d34fa170f518d37dc0080dce0aa1c4883d96d84e79", 1427248616, 0x01060000u },
        { 524160, "00000000016669496bfb07f60119564ef8c9b505b901b4412218bb1ffaaa06d6", 1427376140, 0x01070000u },
        { 526176, "000000001dca1db053db958a666afd71bb7b89d8b5f2f51a12bfb31a7bb93ba5", 1427503438, 0x01050000u },
        { 528192, "000000000442b3b204362043c809b81a3b31aca54f575e17c18efd9b4e73e074", 1427631058, 0x01060000u },
        { 530208, "0000000005a5307860626c9032cd2603fd58c9057db3f9adae41e1210ee848f5", 1427758349, 0x01040000u },
        { 532224, "00000000196ab91a56dd125a9436348110ceafff842b1ad3eddcc868de4b2066", 1427886168, 0x01060000u },
        { 534240, "000000000287595f6dc143ee930a60c74ded11f83eb5f4f2420f289535424e94", 1428013179, 0x01060000u },
        { 536256, "000000002944fdb1f86d6fa7fe4f2a9dbd2ad199c0bff7fb69ca3738dc08b2eb", 1428140322, 0x01050000u },
        { 538272, "0000000019142cb910950a6e94b62c6e15ccbb7c95c2d639a62e5975f88d3d7a", 1428268110, 0x01040000u },
        { 540288, "00000000031d973f91861bf2497ea92d04db3ee8a3c43f7700819074b76fcb59", 1428395115, 0x01080000u },
        { 542304, "0000000029dde95226341994c0d92498d4e062f5c15ca01479fac267f1665743", 1428522576, 0x01050000u },
        { 544320, "0000000011b620d38af58dafa349c2bb2cae72dff97cbff69261e71d2ead6104", 1428649994, 0x01080000u },
        { 546336, "0000000017eff846e845bb4e49e45370d706047f36ec91e5ba23e674f0430dad", 1428777809, 0x01050000u },
        { 548352, "00000000139f8fd82cc3085f1b24c914fee9d10bbda59affc47241357ab57405", 1428904156, 0x010a0000u },
        { 550368, "000000000e66b5017cf76c6dd8c5742f2a5dbfa817d4389cecd8d41409c5bfb9", 1429031804, 0x01080000u },
        { 552384, "0000000013400ae02a97478be976392a937bb8679816079d7b90fccb98a557d6", 1429159343, 0x01090000u },
        { 554400, "0000000013b441b31530b0b8360474ae80392d60b02a542606f8f9de1035287a", 1429286519, 0x01090000u },
        { 556416, "00000000144addc32870c4a8236d1141b715788c696a32962fbe70c95b3aae8e", 1429413830, 0x010b0000u },
        { 558432, "000000001832e439625a803632e64ebbf23a194a8daace4aea220597050b3aab", 1429541247, 0x01090000u },
        { 560448, "00000000020b38ea966142a413a8043927b6b53b514ebaffa8820c9840845c3e", 1429668837, 0x010a0000u },
        { 562464, "000000000daa2903d30c548d146e40316647bf328ebb01fd308acb6bf80851b0", 1429796458, 0x01080000u },
        { 564480, "00000000168becbdaf698d6347348af8e5cc347b87d60a1492d43a88223f6213", 1429923754, 0x01070000u },
        { 566496, "000000000b27fb747b90c9429d64dc4f796a52af15216c5406df99b1b3cbdc7d", 1430051210, 0x01080000u },
        { 568512, "00000000126f61833aa4e43b0adc8235124d368764e179ff4825d93bb5d0c0dc", 1430178996, 0x01060000u },
        { 570528, "000000000286505df890b414c9b7d001a81406d7d67f1eb1945aa0e7b348806a", 1430305521, 0x01090000u },
        { 572544, "000000001938eb55b0a5d2f165a335190066bfa490b1dd66167422c55819141b", 1430432760, 0x01090000u },
        { 574560, "000000000b5e535a563347e5f50da5ee558e422e8d8cabb664abab0933c19546", 1430559863, 0x010d0000u },
        { 576576, "0000000001845f6d7256b1cf36356ae248682270eee4196affaaed7c2dd67837", 1430688015, 0x01070000u },
        { 578592, "0000000011fce5ab46f5c2d2e4166b5bc710a15db478802fef59494eff28d59a", 1430815104, 0x01080000u },
        { 580608, "000000000365d06c3aa98d5dc409e291cdf88df1d6bcf37b6e1c8a79302fb2ee", 1430942509, 0x010a0000u },
        { 582624, "000000000e12b2c6410ce94c5cda31ebffd708e9f9de1182c2951c85be4b97ab", 1431069617, 0x010e0000u },
        { 584640, "000000000ab32a8347bc323d2cd258a3233b4dd776f4b2a85b6635fc171d1803", 1431196767, 0x010e0000u },
        { 586656, "0000000006619ca75665ea318dbb7713ed34227f7c8f3589bc27b7d9d58e15fb", 1431324573, 0x01080000u },
        { 588672, "0000000002ef8078a13aecc457ba6878ab3e0881919546981b6e7262fd1c86a8", 1431451834, 0x010c0000u },
        { 590688, "000000000973693f6163da4824f177f9c8ce847e6aaf0d00cebccb2d8433dc07", 1431579473, 0x01070000u },
        { 592704, "00000000021fee8a5a9b7295f30ec9be46122d56282b5051fc8ce312efdae2d4", 1431706987, 0x01060000u },
        { 594720, "0000000015363cd27b342ac27fc8a18c044a7d1535fa43a9138ca7276cac1162", 1431834418, 0x01070000u },
        { 596736, "00000000042b427cd081c4e34b9339e16aa5e0bc0e2478e1a6bfb260c83d0fd7", 1431961820, 0x01070000u },
        { 598752, "0000000006d1df593f2aa1e794a79521c57c4236ffa5e4fd958136dec327ea4f", 1432089352, 0x01070000u },
        { 600768, "00000000059b8302b6ac12ee79f4aa70afa814f33454d9594712f11c7071cbe4", 1432216132, 0x010d0000u },
        { 602784, "0000000017961a8f52a23040e98bd4e2b189aa296a85052fb67b844553ff8912", 1432343234, 0x01090000u },
        { 604800, "000000000d187aaddb50005601d1d311c25ebec1cb1a34c1b32c0f7d25da83b5", 1432470535, 0x010f0000u },
        { 606816, "000000001208fe9b5e1a567ddbeb4f2332239f63994b387d0474dd33c40265e8", 1432598228, 0x01090000u },
        { 608832, "000000000f9535127c105c9993e49f8890705ab958ef4f475be8b80f3bce7ea6", 1432725608, 0x01070000u },
        { 610848, "000000000d6bd9e381782e594696b238d9317657ab991e5627e06a7cf341d293", 1432852749, 0x01090000u },
        { 612864, "000000000b9c04ee46e618f84c568d16420a46b1b19684060d0ba59e990f228b", 1432979729, 0x01090000u },
        { 614880, "000000000edc560db628b496d2e634e367042f2c2a7060def12e0969027cc69f", 1433106812, 0x01080000u },
        { 616896, "0000000012c0d81771bcf1ae3af976e3c333c78f7484c98319ec4eec04fcf942", 1433233787, 0x010d0000u },
        { 618912, "0000000011b7b76592ba48df222d8c8cd6bf1b2e062db074d22ef6cdb444b5bf", 1433361209, 0x010a0000u },
        { 620928, "0000000016378403ba1a7049730953867a5f7e386a62a548fe3a31bb7d652b11", 1433488645, 0x01070000u },
        { 622944, "0000000009175b0dab174edc82760a9a01dc3b9977bbc89a18d5ceac9b2714ec", 1433615855, 0x01080000u },
        { 624960, "000000000003c5946d785d14c0eff44c05869d01b264ad5a94674440c15b5fed", 1433742906, 0x01080000u },
        { 626976, "0000000005c6bbe0b414972a0bbdc6220da446686f710126a369de91a7dac86f", 1433869705, 0x010a0000u },
        { 628992, "0000000001962a962f7e98c95c27f98f61e5e321e484f0492d9be4052acc0a8d", 1433996844, 0x010d0000u },
        { 631008, "000000001aa9d0a13459402d728654c82f5e4cda5d3e929d9e792199c7690215", 1434124635, 0x01090000u },
        { 633024, "000000000244f49bc8d9e8c2b9d0ce878cd93c4845251515d00fa1ccd8b6ed27", 1434251688, 0x010c0000u },
        { 635040, "000000000469eb6fb8a36936a4b43a1d026b8d74b7825a10defedf6e051eb351", 1434379428, 0x01060000u },
        { 637056, "00000000092d746af6d5b32898b16ad02fe93abae80d6b7cd6b1fbfd21e8b6a4", 1434506854, 0x01060000u },
        { 639072, "0000000005978a5aa0cfbaecfa921f31d182adef4bfe369604339c444664adc2", 1434633724, 0x010b0000u },
        { 641088, "00000000122bbc5386d395eff916d4920b4e89d48d58ee9f4d598a165cde5085", 1434761285, 0x01060000u },
        { 643104, "000000001f0b1bb9ed09360fa17d67f461d673aae37ddaf014b704b6df19508f", 1434888534, 0x01070000u },
        { 645120, "0000000000a44d7eecee1b05206d089da8fabdfe9096aeff09a09ee45e3a008e", 1435015076, 0x010a0000u },
        { 647136, "000000001a05587ff61cc19758b7a482fa251fc833f6567ba9c7859e1e179d4b", 1435142614, 0x01060000u },
        { 649152, "00000000027e16a665382e196540ac73432ec768823c6133b893c894e1fe8c81", 1435269442, 0x010c0000u },
        { 651168, "000000000c554434e7deff44528fe99b37498976cf90f0f0d6fc663ecade15d3", 1435397000, 0x010c0000u },
        { 653184, "00000000125134591988db939c5a6e87e1b6e8d7daed180e12596b701ce01461", 1435524274, 0x010a0000u },
        { 655200, "00000000143c414b3cd97ae0cfb4585a96900f9e4edd47adda3c9990a8fa986c", 1435651643, 0x010b0000u },
        { 657216, "0000000015a3d3f37ded9257ed62ec8afac2c2e729b66218c5e63c26a689ae2c", 1435778815, 0x01090000u },
        { 659232, "000000000be216f6212dd58885ae963783f60d652dc0a28d99255c57dcb407ae", 1435905648, 0x010a0000u },
        { 661248, "000000000cd6298481ac8a46038e498909800bf74dc3599902dceb0d1c1d8e02", 1436032703, 0x010a0000u },
        { 663264, "000000000a5e1087685cd359dd48bfb7176866b607191145b87cc2adeebb2701", 1436159846, 0x010a0000u },
        { 665280, "000000000f3c70aa4415c22b6c557ed04ce2f06e53f6cb1ffd209c8cbf3142f1", 1436286975, 0x010b0000u },
        { 667296, "0000000003f73c6253401b9d69c47922b381accae99e6c076790b7a324a2fd76", 1436414090, 0x01090000u },
        { 669312, "0000000011c74d459984ea70efdb9e2b7307603d683789d729a106bcb3673152", 1436540732, 0x010d0000u },
        { 671328, "00000000190030bdac7ea11bc274777ede17183ecbc92bc50130443682c5ffb4", 1436668737, 0x01050000u },
        { 673344, "000000000805bdace3616476ce5cb57f72a00c7573fb2bacd5cec1f131cc06a9", 1436795175, 0x010c0000u },
        { 675360, "000000001cacfeeb0a398e23ef3998ef82a9a94320afcf2af4596bc536860064", 1436922735, 0x01070000u },
        { 677376, "000000000fcf8f1b668da7c43384d13b6db01b3dff80a6364c48131b7c9122bd", 1437050034, 0x01050000u },
        { 679392, "000000001b47a54fda2df8035e8c7ce8002ed3d64d50ae3f8088038a3bdbb312", 1437177150, 0x01060000u },
        { 681408, "000000001035c473b5867ac4051bad4bb276cc17e97aded5a11da2fae684142e", 1437304426, 0x01060000u },
        { 683424, "0000000001030fd20d443a3fa49b288f4e45052c590dffcad82150b71ecfee13", 1437431912, 0x01060000u },
        { 685440, "0000000001f663060516c29abf47cb14f1dc45679574c36ed74b05b61d97011b", 1437558669, 0x01070000u },
        { 687456, "00000000010034f385e07ebd98c6b7dd6d7a124d9dd0d5419648d6c488f5ed91", 1437685796, 0x01080000u },
        { 689472, "0000000010f98a96642b551a855638c055c880d940b58ec8bcc004966fe0bde3", 1437812805, 0x010d0000u },
        { 691488, "000000001290703ad0e2999f64c5c24bcb5a0db2470231ac113c3c74e0fdc0c8", 1437941018, 0x01060000u },
        { 693504, "0000000004d8ffeaba13cc963000c297add5548cf97c69bfa9810c0b13330e17", 1438070076, 0x01170000u },
        { 695520, "000000000d7a341ca0a9f003c5dd65e3a96841a5dacab8d905a2cbfabbc83ca4", 1438200643, 0x010c0000u },
        { 697536, "00000000004210f7df3ad02e142e5ac74b097850319b27462252c30df6a8e4d4", 1438328587, 0x01200000u },
        { 699552, "0000000007542ce97c8a4a320b6901c861442094659f741fa020cee4c1179b83", 1438458871, 0x010c0000u },
        { 701568, "000000001dcaead7dca9c36b78e362adfb6b8faa9fba726db83cc013fccf3724", 1438588910, 0x01030000u },
        { 703584, "00000000244515ff29005dc02f2a22ae48cb0ca071c62f3b47125960dfc6c4ed", 1438716566, 0x01040000u },
        { 705600, "000000002d981f6a76ebfebd3fc560c7be43e0f5f688071e7960d1e4a44bf465", 1438844407, 0x01050000u },
        { 707616, "00000000004bc44f9a78fc70e8698e758ba2211fbaca5a0cd3470d5dc58ff6b7", 1438971297, 0x01070000u },
        { 709632, "000000000b08f4cd2051fd8977e75b5efc463832310acfb4a1de6c0e948a06c0", 1439098850, 0x01070000u },
        { 711648, "00000000144000bac18bd4d35aad1d04f1ff5705624b9552e70ef709cfd69ade", 1439226144, 0x01060000u },
        { 713664, "000000000636faa1a50584c536a8deff834403d5b6f06338803a0b1cf0ac850f", 1439353581, 0x01060000u },
        { 715680, "000000000d87da48faa6166af7eb04502198bc8e85ad97067b45b75241529405", 1439480542, 0x01080000u },
        { 717696, "00000000014aa9ae61409d1c8ea092ef107630b578ed70258130388f869b6ade", 1439607955, 0x01060000u },
        { 719712, "000000000e8c71ad75b19687d837fd6fbe9a7b81bad4fb83ae3b882be9f4dc09", 1439735725, 0x01050000u },
        { 721728, "0000000004d64e306653ec3fb2baa0608b2fc8edeb3510b779831b83c0834ddf", 1439862651, 0x01070000u },
        { 723744, "0000000008572f41798203b0392210f6725c30be5077703126b758eaeed33c13", 1439989961, 0x01080000u },
        { 725760, "0000000027bbbe5fbe3e5e389c983fd4847067e2740e48cb4a0f777ec9751732", 1440118113, 0x01050000u },
        { 727776, "000000000430ffcb6438e774c4bb93b2074031ffd89e1805ce24b6cdb83170f4", 1440245100, 0x01070000u },
        { 729792, "0000000006d599bc553ca59cd9f8a215d24b8a5666b3a3cd01b2366d8d1e5e0e", 1440372264, 0x01080000u },
        { 731808, "000000000f32afb2355adaf87020574ff080d8c54f60324ac8aaca8fe50fafc3", 1440499239, 0x010a0000u },
        { 733824, "0000000019c8445d91e33b3d334a7f19deb8a69a3e73117c482541947a8e176f", 1440627066, 0x01080000u },
        { 735840, "0000000006251635a479b6bd85df7039f92ef4be5524819c17f5f29c0156c692", 1440754483, 0x01060000u },
        { 737856, "00000000054efab4bf3fe19c5c4696b1b6ca9aa43dc6837153c6a1c3cc20a5a7", 1440881979, 0x01060000u },
        { 739872, "0000000009b41f50dd91a9f2e44af4e7b02842e8507e7b4504b3794bf861ff09", 1441009435, 0x01050000u },
        { 741888, "000000002a4206bddcecd2a7160ed1e045404952e8d0adeb59b8424568440256", 1441136650, 0x01060000u },
        { 743904, "000000001c60b03172108d1d8d2ac57a49fdbb567678142450a1d240f6614339", 1441264213, 0x01060000u },
        { 745920, "00000000053bd81704188d04cc4d0cbbb787f54e78e4b792d0c8784a9dafeb34", 1441391521, 0x01060000u },
        { 747936, "000000001322af489657e177d5ceb897958ac8601de75d5df9b48b23723b2d34", 1441518532, 0x01050000u },
        { 749952, "0000000012d1837709b3ecc5d707999acaee23e9bdddf7e297eb89991d588c37", 1441645985, 0x01060000u },
        { 751968, "000000001db4b3dc30b0e6c276322f87c4f405918b80a8d8ad3bd51f34f8c18a", 1441772881, 0x01080000u },
        { 753984, "000000000511c9915e65299dc5b0c562b9a8338971df0d460f43cf04b3a7c199", 1441900027, 0x01080000u },
        { 756000, "000000000cc0f6a3f50996bc9a218ddd46f5e6719a60b504ea044bb53188adbc", 1442027600, 0x01070000u },
        { 758016, "000000000490bfdbb3dc9ffa9ca5e591dfa95fd159b41aa71eba45a3161a4082", 1442154885, 0x01070000u },
        { 760032, "0000000003f8f890eed8e11254bbb31a0520b6956d2c8a994b417a6b3ee7855d", 1442281868, 0x010a0000u },
        { 762048, "0000000013c2cc8b9730a526dfb76b7def4d16083616bc968b26b16d14e50956", 1442409986, 0x01050000u },
        { 764064, "000000000e0ec7f96b2df4ffa0e2ae413f14d66f92ce67fd36c6ca0c5dcdde98", 1442536735, 0x01090000u },
        { 766080, "000000000234bd79cb06956507ede90551d25bb908aa95cdace0d40735cc08b3", 1442664015, 0x01060000u },
        { 768096, "0000000017581ba7acec88fb7cf2c3665a4ef72e85ef0b9ab7bf691cad8e3360", 1442791674, 0x01060000u },
        { 770112, "000000000fa77eeeb7b58cab32fa4cd5f3e31a3257bea98511e0565e5cc15780", 1442918894, 0x01070000u },
        { 772128, "0000000000b648940682302bd98626a2fdfbf245d355392c5afccd3da27a4025", 1443045580, 0x01160000u },
        { 774144, "0000000005d409e5e49edbdae5beb5b0589cb0cbcbc989c9fddeb09848d49540", 1443173205, 0x010b0000u },
        { 776160, "00000000040381fa9a7184851b9b4bb81ae093f0ac59016d8f6be7cb35f97f24", 1443300235, 0x01100000u },
        { 778176, "00000000085687bb99c138ca8b7aa2da5f5625611be2e40209a5fefcab13654f", 1443427752, 0x010b0000u },
        { 780192, "00000000024a154e5c2064485964aa15079bf488d84784f7d4a6db39e82b0e47", 1443555041, 0x01130000u },
        { 782208, "0000000005115bc5b501068b88bddc3a48dd11df6309f6d15a984c684c5defbe", 1443683066, 0x010c0000u },
        { 784224, "000000001930c1b9bff091c423b8a06b66faef4377c4b0effb129142fca4bbb6", 1443810756, 0x01080000u },
        { 786240, "0000000006d09f81c898d3d91323c2e1403719add8dd497781df24cf23c0cf0f", 1443937315, 0x01090000u },
        { 788256, "00000000022c699a7b593e7dabe7f548c9579585175e76e5f93173775ac711ab", 1444064515, 0x010c0000u },
        { 790272, "000000000b953b3746c4def5ebe47a2929273cc57048d71291fbf9b668c82d4b", 1444191567, 0x010d0000u },
        { 792288, "000000001c23eb6a95249fbce464494ae1ba375f46b8431fd08afd2dd9d2eec3", 1444318902, 0x01090000u },
        { 794304, "0000000011570d2d335672f809cc01ed4fc6aa5233906c78f8154ec646258ded", 1444446098, 0x010c0000u },
        { 796320, "0000000004b04970777e1e69e6169ac3192762b348afb5318857572c43e6bb1d", 1444573408, 0x01090000u },
        { 798336, "0000000012e20280e8da2bd484c6331d9b9e3c45844535582c4ecc2567349c76", 1444700393, 0x01090000u },
        { 800352, "00000000058eb4ca48b82401be152acd58ab52bd79c4a58fb1ae829345706113", 1444827990, 0x01080000u },
        { 802368, "00000000000047688fb1f860a2e02a99fc788cf325b66815ac5a1d6e5b885866", 1444954624, 0x010c0000u },
        { 804384, "00000000159735247872614d4b8a86d82043cf46e6bc54cdee0027b233f94119", 1445082207, 0x01070000u },
        { 806400, "00000000089928d0a22c1241643954e1aeba5085a7c3b6b8f163335b0d2fcb0c", 1445209062, 0x010a0000u },
        { 808416, "000000000e85f80c01bdeb4e29f94f637838abbcfce2f02f5315984e12e66cee", 1445336043, 0x010b0000u },
        { 810432, "000000000a51353f1a79a9d698a21fc027fd388f79d1a26189057da0f33cfd5c", 1445462878, 0x01120000u },
        { 812448, "00000000178b496a5ab289f251be58c14acc0d586a5af3f449a5828dd708981d", 1445590659, 0x01090000u },
        { 814464, "000000000834687c8e2ac4afbbe29eaf7474732cf72757d19946700a2150841d", 1445717704, 0x010b0000u },
        { 816480, "00000000149a719f35fd3bef08e2c772388c2f59699392e6530d6cc91b15fc87", 1445845065, 0x010a0000u },
        { 818496, "0000000005600cce8ba124e37d711dddd23cc0f2dbfaac600e1a3c3200ee1935", 1445971908, 0x01090000u },
        { 820512, "00000000022f392857a43b735fa30e9d85fb2bea36b270015210b74d76671106", 1446099258, 0x01090000u },
        { 822528, "000000001248296c8d9bf75a73e59add43b5e2a3cba352b2992a3283a1a2dff8", 1446226445, 0x010a0000u },
        { 824544, "00000000143d931b0252b652d5abf75673295db2c162e4fe963a98b2f4808b72", 1446353542, 0x01090000u },
        { 826560, "0000000017362a7705ad038b2e366cab5143583d9b9e80d76567bb21c56b3d73", 1446480774, 0x01080000u },
        { 828576, "0000000017dcd4edf1d2df1176c87d57f5492792f2e9b07b081498e54dfeb986", 1446607855, 0x01080000u },
        { 830592, "0000000008f89b67edf2128b9e6c65b93c22eee985eceea602e523ce34680e76", 1446734915, 0x010a0000u },
        { 832608, "000000000c4964729ae35257c169bd27e5da88c28912b8bfdab7c4c9b1438472", 1446862244, 0x01090000u },
        { 834624, "000000000658c009083e7e4629df64da25cc6a09b3f208addf7faf7b577d00ad", 1446988884, 0x010c0000u },
        { 836640, "00000000091d91e7845e575f442451270630417138657324232fbb608a17ec32", 1447116726, 0x01090000u },
        { 838656, "0000000005312c24832b6187803524eca9c87ffda3a518560e4ffeb05d3bb09c", 1447243640, 0x010d0000u },
        { 840672, "000000000c7e070c18fbe2aa051ab6c1043bca7303b5a45d0ecd4d5a27fc0e74", 1447371119, 0x01080000u },
        { 842688, "0000000000e54233068fcab9a1b55212ce0301cbd5bbb2c50baca014ffd1e74f", 1447498276, 0x010a0000u },
        { 844704, "0000000001cb7ad0ff93ea3b4cf0580322f4d632618135f79ade4f30dc1e8611", 1447625367, 0x010c0000u },
        { 846720, "000000000f76d35b9d8c5d5531a6acbba19531c5229c7b61c4109256ec0fca68", 1447752603, 0x010c0000u },
        { 848736, "0000000018bcb1b2f6921cd6accaf8c4ae48c23d176ea9ec91eb902b77fc20e1", 1447880068, 0x010a0000u },
        { 850752, "0000000019108793fe8ad51320083d14f91b0971adeee65b06cb7d3762fbd9f6", 1448007194, 0x01070000u },
        { 852768, "000000000a39bd1cf0e210f37d8ef3e0e155c8a13b8eec33dbbf4b27ce00a43d", 1448134112, 0x010f0000u },
        { 854784, "0000000015e1fa81a324d096136d89b31669d7f0d950bd1687096d698bb23151", 1448261598, 0x01090000u },
        { 856800, "000000000cc8b1820cf6d605ad7b10aa5ce089ca0a7eeeec411b22b2875371e5", 1448389110, 0x01070000u },
        { 858816, "000000000541953c6704f1341c4dd1cabe70a3490a5dc9771215056c82436a25", 1448516041, 0x010b0000u },
        { 860832, "00000000187432eb7e76c1055a69145d1ef3c4db83f22a56c00325fd06c67b3f", 1448643390, 0x01060000u },
        { 862848, "00000000109c79589cd3e971bcda6e202330004ea6d30a8d462e71f7a1d832e9", 1448770058, 0x010c0000u },
        { 864864, "0000000009aa4818a7f63ade165f3073066c442a2024e1ed4d18e9ba3a40c2e1", 1448897601, 0x01090000u },
        { 866880, "0000000003fb9de385dd2cfde1eebf62a1ceef391f204494bba4070f345127bb", 1449024093, 0x010f0000u },
        { 868896, "0000000004d29a2b37d46a9a2132ebb6211ba748823a304ea3b680374327a2fc", 1449151231, 0x010d0000u },
        { 870912, "00000000144655baaf769867b6b8d618b013499cfd1ba50df9929b644aec4895", 1449279387, 0x01070000u },
        { 872928, "0000000001360e87fc98dc70b282cff9ac4fa3376dd588c5dcb8381722242ae8", 1449406284, 0x01090000u },
        { 874944, "000000001126cc90ca56055e2b2f804e274dd0c2379f9bda752bad29ebb4f675", 1449533161, 0x010b0000u },
        { 876960, "00000000178f3e7eca4e99a9ca557bd3ca58de61dd6a2af350802221a0cd7885", 1449660769, 0x01090000u },
        { 878976, "0000000009c4755c63c76e03a95f95b38495acb827fb22e67064ebb30a151980", 1449788051, 0x01090000u },
        { 880992, "0000000002c92eace799a0551362ce200c2363f6f773084f7532b599b3ff39f1", 1449915006, 0x010b0000u },
        { 883008, "0000000007cc071385c01f2716ee49b34726f15a8ab9b6458da3a5d5b3b4972f", 1450042437, 0x01070000u },
        { 885024, "00000000073031cfd4bb09a420598ce23ff676a8cb00c11dde92b9dc3fc3f902", 1450169150, 0x010d0000u },
        { 887040, "00000000129b6726b21d68e68c065f172ce6e196579a121b5dcdfc0b560a5caa", 1450296437, 0x01090000u },
        { 889056, "0000000009742f089e5525d473fcd51e079d5b8fd6265c16a6b63bb12a2fabf6", 1450423779, 0x01090000u },
        { 891072, "000000000edb2eaa6f8589a4420bb76e138def931f4fb60c1656ff74d0fad6ee", 1450550596, 0x010e0000u },
        { 893088, "00000000199b41613dad1ea683f596906000543f19c6d74774f425b3d246e7f8", 1450678202, 0x01070000u },
        { 895104, "0000000015e9cc24fe2a9ba038edbbd945c840526f40228f171e5ae3cbe2afc4", 1450805548, 0x01080000u },
        { 897120, "0000000011108b0bd659edd60cc3410bbbf50cae55bcd61f382ea101ae1b5d38", 1450932136, 0x010c0000u },
        { 899136, "000000000f1df766ce9e0c24dd5e2a3ca05fc0dd5db2647c098a60733b61aee7", 1451059389, 0x010b0000u },
        { 901152, "000000000c558185e8bde3b2781730b32dafea784d4b86c73b46e79541445d87", 1451186413, 0x010c0000u },
        { 903168, "0000000014ad7434ee93115bc99d0ce95d50a72ab0934014ac59053e42be259e", 1451313482, 0x010b0000u },
        { 905184, "000000000e4b94bebcc0baed50a8e235ba2cfdb392a6e8aa218c65c840d85feb", 1451440618, 0x010a0000u },
        { 907200, "0000000010e252bd5a39b3656f67147d7a3c6ecf55aaffbdc0dbc27ef05c0a28", 1451567883, 0x010b0000u },
        { 909216, "000000000f5866abf0b4efa93ff6ebb2cdfb69823011629b4370d5943e5a4a5f", 1451695134, 0x01080000u },
        { 911232, "000000000c573f06daacee0cefa13a46d2cde3b1872312d76fcdc7e01270cd07", 1451822184, 0x01060000u },
        { 913248, "000000001138f7c60021a04d2e2b8c50147b1485774a6510d6a0a7d657937d53", 1451949580, 0x01080000u },
        { 915264, "00000000156ce929f183f59b6f7415db2e62822d244e1d8b08868152971cca71", 1452076433, 0x01080000u },
        { 917280, "0000000015c88980d04bfa94c6bd3862547ffe582bb2a566897e9c41f6983010", 1452203774, 0x01080000u },
        { 919296, "000000000d6e7e38a0827ba14d4bae6f9bf8f77c8704387288099f1b96199aa8", 1452330774, 0x010c0000u },
        { 921312, "000000001ffe6bc6fe88698a5f1f92028f82c5d109d92a89f25c7ce467a40230", 1452458397, 0x01070000u },
        { 923328, "000000001230e70dbd56ad044c8ca3c87636597d4a38f77211426e7c2f351079", 1452585380, 0x010a0000u },
        { 925344, "000000000ca5a7091ba02eb2bfce4dc92a7a833608f7a7966c77d15d157ba742", 1452712854, 0x01090000u },
        { 927360, "000000000190c8bc73e911b6cd219ad5a9e27ba1a7cde424afba953032e94434", 1452839491, 0x010e0000u },
        { 929376, "000000001044d9f9139406068fbb6b5bac2cbb91e917d831a46c08ac9f068ebd", 1452967198, 0x01070000u },
        { 931392, "0000000009bfd7de2a4fadd85491a4b79343fd14079a6b8e83c3e850bf099771", 1453094173, 0x01080000u },
        { 933408, "00000000139d82a66b9136589969008c9d4d37cc5239837dcdd71598aa622019", 1453221333, 0x010c0000u },
        { 935424, "0000000014cba9fe1855ae03ba758b87b6bf61bd795e0a016483f529ab4600ed", 1453348472, 0x010b0000u },
        { 937440, "000000000d20b32d66cb02f49cf846b6970811f3471ae6e6f0fd4202f888178a", 1453475477, 0x010f0000u },
        { 939456, "0000000004080c750bdf7ad5f57f297cb9f37017422b8c8d4b7e4e9f331e2556", 1453602981, 0x010a0000u },
        { 941472, "00000000077fea2ea737be69c95ba8f72632c1f6eef9da0c58192b1052dafc5c", 1453729804, 0x01120000u },
        { 943488, "000000001c74589873c6b0d87163b6ed7f721d44c619d27d754957316ee6e550", 1453857530, 0x01080000u },
        { 945504, "00000000101dbed28ab175b2f7872cae37a5398d9773aa46b3977ccd9c5853a5", 1453984181, 0x01080000u },
        { 947520, "00000000004743371e2c22840bf03736c3f65971af19a34f932739e023222363", 1454110820, 0x01100000u },
        { 949536, "00000000119ddcca0ad06df72d2497eb951c705852a6519a0fc328303975afd5", 1454238461, 0x01080000u },
        { 951552, "000000000cf2c5d563de1bc70e68b6d67c254bcf50e4427a9fcb5099b47d82c6", 1454365645, 0x01090000u },
        { 953568, "0000000010241d446fb83b869afd81ab898035b60771e48bc5d7e14060adb75d", 1454492619, 0x010b0000u },
        { 955584, "000000000adce36e945d02fa30bf0212a92125734980fe89b23b9a93ca2ae2a8", 1454619907, 0x010a0000u },
        { 957600, "0000000012509d3ee70f0896922fac9bee1236405ac200cf667f38179b6755e8", 1454747103, 0x010a0000u },
        { 959616, "000000001085905a6878f24f81e644483809efe457a24ea81081f719f68b77f2", 1454874920, 0x01070000u },
        { 961632, "0000000002428fb83177fb516da5443ddd2624e21d19df5ba1821729928f664b", 1455001789, 0x010b0000u },
        { 963648, "000000001e2ec0f36b6366c85d581b9eee6f6a08e51f73f4d6243395c98c87d1", 1455129354, 0x01070000u },
        { 965664, "000000000c4578e3b20cce041dc23245a7e0f8fb2bec51aee560e438e1421ffc", 1455256041, 0x01130000u },
        { 967680, "000000000efdba6ff3659ef7e6b1ad5389793a150b7169d1ab5e50ebff514a5c", 1455384005, 0x01080000u },
        { 969696, "000000001481c3769f4977e3cf29df45cd58680ffc87d35cc5c6b50ec33de74c", 1455511453, 0x01080000u },
        { 971712, "0000000016eec2234b8cb32aec4f8379ee8b704f918cce4da9136b09ca30e4de", 1455638605, 0x01070000u },
        { 973728, "000000000c1fab02b8d1ebf4e0e8b5d60e317e242a1fe0d4a2b94ffb1ff5ee95", 1455766522, 0x01070000u },
        { 975744, "00000000075fa002a20f3749ac3612e3a6e8d075449bff446a3c6f92a123b700", 1455893473, 0x01100000u },
        { 977760, "000000000daa440207ebbe70e2b20cc7a561d732aefbaf62a1d3beff05a1ae7d", 1456021099, 0x010a0000u },
        { 979776, "00000000077f1c40a4b3f660e1205986ed7ad6f889cb65b196cec0d6a7c9d761", 1456149197, 0x01090000u },
        { 981792, "000000000879b0344a838963efa44bcba937d7a29db43e355345729dd1111669", 1456276510, 0x01090000u },
        { 983808, "000000000d39c365cf8773712818f389dd3f64d6796f90c03a9f546cb4f0c7e6", 1456403600, 0x010b0000u },
        { 985824, "000000001df764887ab1b35396bd75d3420cd4651d4ee38f61997a5513150f76", 1456530976, 0x01080000u },
        { 987840, "000000000c0f0f47bdd4a3b19220c3be3ac7d8f3451c32ea2f63d6931867d3c7", 1456657720, 0x01080000u },
        { 989856, "000000001a5d1ebef80038dad154e673c2b82856c84d19d2777f8f7dc0fb972c", 1456785094, 0x01070000u },
        { 991872, "000000000d249f798369e387b8188025be01567a66f638956fce2437ffc1d1f9", 1456911719, 0x010f0000u },
        { 993888, "00000000023b6bc04b451947bb06394feb9da2298989f5463cc2ebd7cbc6d9be", 1457039374, 0x01060000u },
        { 995904, "000000001492d10f5efb86346dc5c2e08143af3f96d90789cded053a44130193", 1457166444, 0x01090000u },
        { 997920, "0000000010bab6071c77eff7613d90d67c65d374f802e7af3d2c27d4b8d9b813", 1457293939, 0x01060000u },
        { 999936, "0000000015fb322151774970b58f825da1f4f71c88f3e6ced8945f6650a90e53", 1457420749, 0x010a0000u },
        { 1001952, "000000000e2ed4dbf8c6b631e6dd1befd34a325f9b4d61f2af3421834a695004", 1457547998, 0x010a0000u },
        { 1003968, "0000000015bc9146237996aced82d6b2f49a0a2199528bb27a600a41c5995f0e", 1457674979, 0x01080000u },
        { 1005984, "00000000152ae7569bc17ea05f7581497bfa5d06b94d3ab1dcc8c8751a94b3bb", 1457802083, 0x010b0000u },
        { 1008000, "000000000ab94421d919cb21bf8232e33f47e2f2cc21af9255c64057c52f01d3", 1457929445, 0x010d0000u },
        { 1010016, "000000000e77461ba5260ec53eb7468232b78f6e01fb3dc951f8cf7199c3af6f", 1458056497, 0x010b0000u },
        { 1012032, "00000000014cf68cd4f83abcbe78d63a4d7a3485da9bfbec85da076503906781", 1458183666, 0x01080000u },
        { 1014048, "00000000151d1a6c16e082cb9f3c9795b864bf8aae3c2bf4d652ee4230470b78", 1458311097, 0x010a0000u },
        { 1016064, "0000000017bb75f2cdd7a06e865cb06e49e3d18f9477e3a76eaa5113ddc58a43", 1458438029, 0x01090000u },
        { 1018080, "000000000e867d60e33e75a027533da0951e4b35e65e379a39352df07a0e3885", 1458565018, 0x01090000u },
        { 1020096, "00000000210d6140ec8e1bc98dca97f1db9f2adc18d2c6f73d2346428bbcbbaa", 1458692635, 0x01060000u },
        { 1022112, "000000000eb3eb77c7b38b6d08dabf9a79abe614e905835d1f496bf029bb4c80", 1458819459, 0x010b0000u },
        { 1024128, "00000000008a9052adae263ea35312b3fb536164c983ce12771ab7e61fa83400", 1458946517, 0x010a0000u },
        { 1026144, "000000000228c7e47a28d36d61b24b823c7a3c2b04650f121659bfde2047df0f", 1459073797, 0x010d0000u },
        { 1028160, "0000000001920f6164a054f5ed27f2e3700dc76deda6451552f9a70359bfaf8f", 1459200853, 0x01080000u },
        { 1030176, "00000000147afb14ddb75bfd9cace840f9ad9c17d44e09affddc94bb407f1700", 1459327773, 0x010a0000u },
        { 1032192, "0000000000edfeccbc0e9a91ad4377721a60768b9728b3307a3156f070ff99a3", 1459455064, 0x01060000u },
        { 1034208, "0000000017256d87a5f0c21cf006bb0d6e45c75ec9cd19548e7874757bfd8d6b", 1459582010, 0x010a0000u },
        { 1036224, "000000001a7a32fed331a7638ad82678d1552642c4f6b5d3830c9fd2417bbeda", 1459709232, 0x01070000u },
        { 1038240, "00000000062f85f35f5b5989e763a733233b65627713c57df06dee99a19d6304", 1459836344, 0x01060000u },
        { 1040256, "000000000cc648a46db0ea6e4edc351248f75829aa43cb7594a3a861ed276549", 1459963324, 0x01080000u },
        { 1042272, "0000000010ef3c4a60d42d35336757c3016dbaf7a45cc08f599b3f4d6a5bd8b3", 1460090290, 0x01090000u },
        { 1044288, "000000001bcd89a6638b0687e306570b4e08bb4b6d208e511354bf7b6403d447", 1460217455, 0x01070000u },
        { 1046304, "00000000082e04da3df42286e0c181d62f2e11c4f551a9ed448dba58b1664af0", 1460344324, 0x010c0000u },
        { 1048320, "000000001930c26be313ea309f4ae455c4e3fd6be93599cea36c1c932527609a", 1460471334, 0x01090000u },
        { 1050336, "00000000193b6ec6c7c268ea18c68279fb58f5f0de9fba1e894b13c35f617073", 1460598270, 0x01090000u },
        { 1052352, "00000000081a184a031136f933571b61c26010acac993002a1d5ca6bc3b949a0", 1460725494, 0x01090000u },
        { 1054368, "000000000c20aad69eedd6ff6acad23ea12a86302c6ae35abc0fdfcc58e22c2f", 1460852494, 0x010b0000u },
        { 1056384, "00000000241336817629f9447892bfc4a86c688839ceef4e497a5ef1a3ef8c92", 1460980143, 0x01060000u },
        { 1058400, "0000000019c42c003db306342622aaeb7d3dc1939d6064ebae9da4117117cd78", 1461107206, 0x01080000u },
        { 1060416, "00000000060db6fee92c3c27f318336eaf1bd460ed3dc4467e5204e9805a0d76", 1461234234, 0x01090000u },
        { 1062432, "000000001178ab7c2938a915e88596c144fe553dbec7b68995631c5236edcd10", 1461361166, 0x01090000u },
        { 1064448, "000000000a474325b21f2d3c3fb21d7441c72e3eefd92bd2e0547b261d35f7c8", 1461488055, 0x01080000u },
        { 1066464, "000000000187473429b9cb2fb224bb27c9788aa698780642bfe939bee5aa3ba7", 1461614959, 0x01100000u },
        { 1068480, "000000000f07b0482c3e90bfec45bb36e4cdddef63dae4d0bc9af7f2e9c12e17", 1461741985, 0x010b0000u },
        { 1070496, "00000000009673257e0a9cecddef6c66c919267fe909d49388d27ed239e5ed5d", 1461870094, 0x01050000u },
        { 1072512, "0000000016afae695ce0a0b9be5aba8b3780eb389d2e1a55bc1c52182b959133", 1461997881, 0x01070000u },
        { 1074528, "0000000021a6dd8a77d2bf6a929fa7c80b6100bc4bb260e1db0e7556e85a7156", 1462125413, 0x01070000u },
        { 1076544, "0000000024d264670287e06fa82be7323b70a2967bae5adeef5dcebd55ccf863", 1462253114, 0x01060000u },
        { 1078560, "00000000031b57f2e908879d8d58e3018ce9763e9ee408a6d2f4ceae9624d80c", 1462380492, 0x01070000u },
        { 1080576, "000000001049e9564e7bac30150a8a4d39dc0c6afab47ee55ffcf0fcd88d82de", 1462507729, 0x01040000u },
        { 1082592, "0000000004cf301947e4ebbf493c89da88162a9fc5d6860f7353cc0c8593a343", 1462635394, 0x01060000u },
        { 1084608, "000000001c37750073195f6df23f43d79866504bb303fab018cf718241fb259e", 1462762858, 0x01040000u },
        { 1086624, "000000001da58919593c26303de39bde2708aba03a0cc5b4f94fe794042c479a", 1462889433, 0x01070000u },
        { 1088640, "0000000010c44b95a6803e30c2b76c0bba651821944e62ca67e22360871c112b", 1463017486, 0x01060000u },
        { 1090656, "000000001f668764fa5bd314fc701739247c11c107d401708174033e3ba3d291", 1463144725, 0x01070000u },
        { 1092672, "0000000017f0b07a63e1db947a86b93d5b1a7135cf7d7704eee3d9e637d71548", 1463272287, 0x01060000u },
        { 1094688, "000000001796721cb33a2ac7bea5725334b1c94115805247e5a8d9ddb40750da", 1463399381, 0x01080000u },
        { 1096704, "00000000181b3fb03bbfe70b5fea88e8fe0d78c56866d31e67ed502a134eaaa8", 1463528398, 0x01050000u },
        { 1098720, "000000000425f4125c2b4200c502235fb8f7c35245af8c6c4da03e63fad1dd8d", 1463655568, 0x01060000u },
        { 1100736, "000000000d0df7bb3db163aea2def25e6b05bde5d019c0beba6c2acd9c6f3605", 1463783169, 0x01040000u },
        { 1102752, "0000000015262780f0c27dc59ddd7b1389c7eeaa2a19093c544442688a848ab9", 1463910232, 0x01050000u },
        { 1104768, "0000000005560334d92c9532af533c86e5a7f9dde42781a9392e576e49d2e906", 1464037478, 0x01070000u },
        { 1106784, "00000000196c61b0c22755a860df88f75e770cd469830b83fcf42374afe6c1e6", 1464165400, 0x01050000u },
        { 1108800, "0000000002e795f6998943d54163ae35f11b1a1d818a9c387ffbee18b007b9db", 1464292943, 0x01050000u },
        { 1110816, "000000001c53b709544cd89237c9a8329ebf6a15573975c6b2b2a0a55dbebd4a", 1464420122, 0x01050000u },
        { 1112832, "000000000c50d523d2bb53a7b75011baa40615abca55057510a01c8f2b444180", 1464547194, 0x01050000u },
        { 1114848, "0000000008d83257f298a7fdc98a93a8bc598f3ba8dcf1c05ecf4ad85d95fda6", 1464674793, 0x01060000u },
        { 1116864, "000000000dbecbf4f1043340694277c3e8d9712b34276e141342be6378621ec7", 1464801848, 0x01090000u },
        { 1118880, "0000000020f800364f17fa20f01ee9c30de6cfe8887a699026017ee83990d54d", 1464929196, 0x01060000u },
        { 1120896, "0000000009eb42b3126f9e91dec82fcf63145c93e06e57652ddf5353b2c48f55", 1465056701, 0x010a0000u },
        { 1122912, "0000000010161a17bb08c17c9aeae608940d65b0b3d9d30dd93e4b6fd53be8b7", 1465183615, 0x010a0000u },
        { 1124928, "0000000007eb1416491b42774ab2ccb25935cc37c0ba9ceb3e6e55b0bee51f92", 1465311282, 0x01050000u },
        { 1126944, "00000000346e918d0744a592477306a3c8bc7eb967f069f5d2906413b18d55c0", 1465438702, 0x01040000u },
        { 1128960, "000000002bff76db3b75b1d87014b9dd490ec9e92e807dae7594a71cb3dcd3d5", 1465565971, 0x01040000u },
        { 1130976, "000000000a40116b2a6d546b18ac0b357e215cf3e26d4315bb434c4fd3b3b153", 1465693312, 0x01040000u },
        { 1132992, "000000000ff5ea227bbd53149eac6dee17aa9e89f929c591445a7c6b4bb14ed3", 1465819891, 0x01070000u },
        { 1135008, "00000000012d373ddcb88414f6c1e3fa948092976e759c4ebf2bc0ccc264f2ca", 1465947370, 0x01060000u },
        { 1137024, "000000001fc0f56201c4ad1ad93bbaaa478160fc6d35f3eb0a13ada10b64ea25", 1466074707, 0x01060000u },
        { 1139040, "00000000232bffb27b3dcf80486929478484813399688170742a25615eec72b6", 1466202439, 0x01050000u },
        { 1141056, "0000000013d164bb3fbe4a50254101b866936fb18a03960ed508956c85ed018a", 1466329419, 0x01050000u },
        { 1143072, "000000001a9b608934c6cd263fbbba6663d70aecd7144ad8eebf68fc919e56d4", 1466456882, 0x01040000u },
        { 1145088, "0000000010e5469b9b8fc50a4f392c968c05d4759e77686ec5ef1bf2db55b3c3", 1466583706, 0x01050000u },
        { 1147104, "000000001fdc3df169963cfb12912aa9a5faf2654173dcd65f560d4d8a4822c5", 1466711169, 0x01060000u },
        { 1149120, "0000000003860417bc0f0ea44cfacc240cc2474ebee9afbe1b8fca448d53472c", 1466838209, 0x01060000u },
        { 1151136, "000000000fccc985537402a01cb1d8754ac87ba6460e7466c08cc88cfbf1928b", 1466965747, 0x01040000u },
        { 1153152, "0000000013cd2dda261930ee383fbaa4b4fc7f62e98d5a7914ea2652aca98bfa", 1467093054, 0x01020000u },
        { 1155168, "0000000011f0c77c82b64542ccd5a8c45d3ad36ec0295de069936668ebfe1ecc", 1467220562, 0x01030000u },
        { 1157184, "000000000d0fcad053a151b8107d5425668a6b99b9a73386d62f4b93c4070461", 1467348936, 0x01060000u },
        { 1159200, "00000000025ac4660272745e7a90d4f9c1f4038c299eff29f4158ae3e1407e45", 1467476199, 0x01050000u },
        { 1161216, "000000000b93d873f9fdb6a622b8afdb008830303107900e8268ee63f6de7695", 1467603688, 0x01060000u },
        { 1163232, "0000000008e4e89cb4728c1ad78f9e39edf3a08506426dfa4dcaa6c12868edf3", 1467731078, 0x01070000u },
        { 1165248, "0000000026034b8662d5ef296830ff8a398cfffd32c3ecc20c8abdb4bf5e3445", 1467858902, 0x01050000u },
        { 1167264, "00000000042bdc57dd1c3866f502ff578280a782435e4f327bd3649b3dcf1fbc", 1467986148, 0x01040000u },
        { 1169280, "000000000a7797b4d59531cac02a4c85be915056b6c957bfbcd48a465e377d8b", 1468113595, 0x01070000u },
        { 1171296, "00000000056aa2fce07bb666a6e690c21cab85d1b996deefddd613b40058adf0", 1468240150, 0x010f0000u },
        { 1173312, "000000000c4bd844f9ab893cbcef0911cb7d1522bd54264c33fc587a4d8c25c6", 1468367610, 0x010c0000u },
        { 1175328, "0000000002c9471f23cac0ab2d0a7169e4a5bf6b8aaf083d256b5961a5c4f1a6", 1468494421, 0x010c0000u },
        { 1177344, "000000002c9bc5fdb52066f88a577e1108397f33bcea62fd1c9e8c285720d1f1", 1468622887, 0x01040000u },
        { 1179360, "0000000012021f6b9a555906cda1c10d8acf38a926f86a750c61909e5c220d82", 1468749800, 0x01090000u },
        { 1181376, "00000000114f32514a84c5f003f238529615291a1ac2b753ad1b249b5ca4bd94", 1468877248, 0x01090000u },
        { 1183392, "0000000018a09f1cc6fc515020102b2d562912096f662af579c062a1e5530650", 1469004749, 0x01070000u },
        { 1185408, "000000000cda9d7401ada49117c63abbc8b6361abf0b71d4a03affd2512c58db", 1469131847, 0x010b0000u },
        { 1187424, "0000000009781c4ab4665682c9924e74f7b49ee8ce8b18372821038ad935e40c", 1469259178, 0x010c0000u },
        { 1189440, "00000000003cbbc01b8c74e7902f8f35bcd727ab4c856a79272ba78292f39c08", 1469386490, 0x010d0000u },
        { 1191456, "000000000ba54608bf261f87b38e2c7ece503dba62e2642f53077150d22762af", 1469514154, 0x010e0000u },
        { 1193472, "000000000159a113b4ae401ec84ec9fbce4af1560590af9e359f5347a9f62a19", 1469641261, 0x010d0000u },
        { 1195488, "00000000132c7ae490f8408666ece2aad5651612ae672e963d5c0698f3cd898a", 1469769122, 0x01090000u },
        { 1197504, "000000001096fbf7c14c4fb90dd12bfb01ae3df39b6ae0fc57a86cd10720a944", 1469896306, 0x01080000u },
        { 1199520, "000000000cd14eaedc04b8048999f27e678d139e21562fbec3d254f1af3362a9", 1470023479, 0x010d0000u },
        { 1201536, "0000000000d3ee9f552f3781ae490a94ab0e72e154b2b4177fff76f1e0dffbc0", 1470150595, 0x01110000u },
        { 1203552, "000000000283676993cd9acbcf0cfbb8d3f7eed7920b5422a60050fd00827198", 1470277486, 0x01230000u },
        { 1205568, "0000000001a1a14a67cfa487001b48cc422ead77201f482494ef69ecd28eba39", 1470404842, 0x01130000u },
        { 1207584, "0000000001ac4e17fded07fb16b94d4433ecc203edcc849d900867fc0f4293ca", 1470532421, 0x010a0000u },
        { 1209600, "000000000b343db79094ac80392ba70694d8db1e10705c53f15dce153918e74c", 1470659619, 0x010b0000u },
        { 1211616, "00000000141b3baab5d0b148cc1f15bd1eed5178efbf09f21f903975f23801d3", 1470786820, 0x010b0000u },
        { 1213632, "000000001115879512f7c6edd6c963d062a3e01875553b63d6423842806636f0", 1470914000, 0x010e0000u },
        { 1215648, "0000000007f276dcad2e195c7d34caa92d7df94fa3db1cb2e353d245cb9bc8e7", 1471041025, 0x01160000u },
        { 1217664, "000000000c800993741852c03485340bbf52208ba8d453939dda24a4a4602873", 1471168279, 0x01130000u },
        { 1219680, "0000000005b0823b0e24b85cbd0d71e94c379025b512c22643a1f10ed73c1bcc", 1471295492, 0x01170000u },
        { 1221696, "0000000006fc972816936883029b0a281881d15f476ecddc33b65f9d6802c0ed", 1471423133, 0x01100000u },
        { 1223712, "0000000004bd4439dcca301a064f464e5019978f0de1df1b585255b931bd15b4", 1471550195, 0x010e0000u },
        { 1225728, "0000000000eb82d12b02bbedfacc9c8dcd3e790a6480a0056504aaf048c64a2b", 1471677628, 0x010a0000u },
        { 1227744, "0000000007dbc1f5e6758d8fb4423dbb9a968c7a41f9f75b968ab9ec675bf7f8", 1471804360, 0x01130000u },
        { 1229760, "0000000007efa26dfbd503fab5bf34d6263a9f76cb11c7bcb68c5cf50c73308e", 1471932680, 0x01060000u },
        { 1231776, "000000001bd3eea4aba511942d7f0895285fdea2b9da4fc9d7c3cb29c7edf2b0", 1472059857, 0x01050000u },
        { 1233792, "00000000059ef7dd770c70f3290a220f617bec6fff520c2868496ccfa9f75585", 1472187583, 0x01030000u },
        { 1235808, "000000001150be00864547070fb364fc1c274b3292bb9bbb0f25039105925d6e", 1472315305, 0x01050000u },
        { 1237824, "00000000179e46d64af4134c8d573f6a308f54de7b27bf725d969cd246e20d55", 1472442817, 0x01040000u },
        { 1239840, "000000002695a6678cdfaa6d1dd4f0b9a55fe7a0548d1ba719dbd44b39b2c29e", 1472570529, 0x01030000u },
        { 1241856, "00000000031f898363f028331aa6280d42110d70c48812cf91a8f9767d68de4d", 1472697955, 0x01050000u },
        { 1243872, "000000001523d1f3e826d700dc31ccb0bcde9d03cebcf740e1a70c53a9783645", 1472825332, 0x01070000u },
        { 1245888, "0000000008325e00ff1aa28d2c022b69b5113cf02410130f2d6d49e57f41ca73", 1472954017, 0x01020000u },
        { 1247904, "000000002c27595dfd6b5c4ce314aa06a4637b53bcee967b78ce122b4b3c390d", 1473081597, 0x01030000u },
        { 1249920, "000000000816229c6a13dca7bab6bedc76837a384cc41b99c971cb5fcddfaa92", 1473208065, 0x01080000u },
        { 1251936, "000000002f7817dfa37b884e455505fcfdd796a3437ab7aeea527c0663d279c0", 1473336160, 0x01030000u },
        { 1253952, "0000000036f1f94e3fb8c38f7b07864d8b019b432f2a18e14bc1ab3c7a962a45", 1473463502, 0x01040000u },
        { 1255968, "000000000021530c36868127cb2189ccfe2ca07e699c2baa9ea2c0d6b14e69ff", 1473590519, 0x01040000u },
        { 1257984, "000000003cae115d0f7657c3e75195785765d8afa25f013f4a5b1c6ff0fe9560", 1473718246, 0x01030000u },
        { 1260000, "000000001257daab793d5ed87a673bf13f3bc5a57d3ddcf5c6227510b4d6a76a", 1473845136, 0x01040000u },
        { 1262016, "0000000016920ef81203565862f059db9046ecb770f7b83a344790a9b2563296", 1473971899, 0x01090000u },
        { 1264032, "00000000119367220494f0de26b603d23be95fbcf3c5357b2ae194e34e68b118", 1474099136, 0x01060000u },
        { 1266048, "000000000fbf6970a69a8e0ba2fc8e5e82e50556157a8933622b64c3926f1a71", 1474226353, 0x01070000u },
        { 1268064, "0000000006db35356699d4f66c4fc11fddd106463a09e4ff100cbe6eb19a2d26", 1474353498, 0x01070000u },
        { 1270080, "00000000152de49b2523a7b129df26680d02c04c63f4a64a3d9e840a5da39a22", 1474480466, 0x01080000u },
        { 1272096, "0000000016ca4efc7335c508b04ac018f93ab8ac0295ffb0459b2200fd99f239", 1474607513, 0x01090000u },
        { 1274112, "000000004de64e413d609576df9ce378d16db48c2895bde5c7f87b80d82f2412", 1474735460, 0x01030000u },
        { 1276128, "000000001711f159871f13455d459b5346b3d5dc3a98433ef2103fb1371e815e", 1474862573, 0x01040000u },
        { 1278144, "0000000028eeafcc7b12a82e5cd0ed3414831c9a51b2e49c30fbb59272e824d2", 1474989986, 0x01040000u },
        { 1280160, "00000000193e22be5f24eafa1ded8dc270ddbd4170de76f501187d0858528b04", 1475117306, 0x01040000u },
        { 1282176, "000000000d717935f1fc9bc8de56017da54524b405d05c5245c49693088050b8", 1475244514, 0x01030000u },
        { 1284192, "000000002f7a11f7f872541e11cd82066fb082d126109494695c3bd4264eeca5", 1475371974, 0x01040000u },
        { 1286208, "000000002b4c6dc729e15d29e0cffc92138064d80ed5ee83802ee0e8125a9ccc", 1475499522, 0x01040000u },
        { 1288224, "000000000d4e79fd86b302acba79dd93faf0dc88207fbb2e92ab550f48308779", 1475626308, 0x01050000u },
        { 1290240, "000000001d6cfecd03e25d375a87aeb2fee77bbb5b533b8fc7f67ed5a648c404", 1475753397, 0x01070000u },
        { 1292256, "000000003c6239980dc6989a27938263dff6410ea079fc15ec92c73bd67cbacf", 1475881364, 0x01040000u },
        { 1294272, "0000000021b2ec8dfa9c39d85dc0d17007daf289e61994c456b31d6ada714da6", 1476008330, 0x01050000u },
        { 1296288, "0000000001a960701921e312fa2dc0693441a2b4ec447d0471351e0e2a877633", 1476135665, 0x01040000u },
        { 1298304, "0000000021d5f1075986db2700f0151db203ba011bb39aef4075adc1f92a7989", 1476262959, 0x01050000u },
        { 1300320, "0000000013330b1064471bdaa0673bc2cf4e2c646027887a07bdc7c40393563b", 1476390309, 0x01050000u },
        { 1302336, "0000000005ac2a7ba5e043e2db577d4c2589a137de37d7b2aaffbac044f3f118", 1476517984, 0x01030000u },
        { 1304352, "00000000044d9cff413baca8162fd34a7e9b75fb38fb28a63a782251816fead8", 1476645613, 0x01040000u },
        { 1306368, "0000000014a5fa9105e04b0ac22620562add6a9e7ede1580f4e8d087fea5092b", 1476772704, 0x01050000u },
        { 1308384, "00000000487de0ae7de16e89e745f242ec93baa32ed28d1f64eed440248deea3", 1476901040, 0x01020000u },
        { 1310400, "000000000417322f840c6b4668fc731a8e2720afa9a17fa70416018197856a1d", 1477027933, 0x010a0000u },
        { 1312416, "000000000806b63471f7c8c712aadda40116b640797f54a00b3e83c435619fa1", 1477155322, 0x01080000u },
        { 1314432, "0000000007a7fc8bf2f9a4bb046749ffdf39d3e1f7f3a2280e8191022c85596e", 1477283770, 0x01040000u },
        { 1316448, "000000000f377dc654cc8e608f48ea35eca0f557a9b110cc1a63a8582b4537e8", 1477410988, 0x010e0000u },
        { 1318464, "000000000a055655edd38fa6f49d187ccff72e977c27b2b696fcccd86a19bbbc", 1477537829, 0x010c0000u },
        { 1320480, "00000000104e52170acbb0ae7cbac5a8a15c65cd239b800e6876208460ec4499", 1477665839, 0x010c0000u },
        { 1322496, "000000000633681d9a5c487717e47a861c545e46db25989be2739e4ea536a407", 1477793780, 0x01090000u },
        { 1324512, "0000000005b136569907f1ae01425558b0eef800534f7351fe9bf42719e08b8a", 1477921101, 0x01050000u },
        { 1326528, "000000000aa60e1ee071764345a53b22ef2b8f731cfac4f59f3ba0b7f2689163", 1478048619, 0x01060000u },
        { 1328544, "0000000014edb4dfe11f8e2bd0ef87bc4a935b807a17d11f0a88ef01d3a14ee5", 1478175791, 0x01070000u },
        { 1330560, "000000000679e1d7b985ea06ee0434779cca00f7c849279369004e6616c0621c", 1478303034, 0x01090000u },
        { 1332576, "00000000104707aa2c1546e0f9a1bd48e871999e418c8486adc64adeae315a37", 1478429929, 0x010b0000u },
        { 1334592, "000000000a966dc89aa3412466e16bc9e4ebe246afee80680941848c220d6e2d", 1478557477, 0x01080000u },
        { 1336608, "0000000001651a69d84755eb4fac3803d9e7999773f86dec27e3b77726e2f390", 1478685477, 0x01040000u },
        { 1338624, "00000000223934dfbcd959f2c2c63cd65f4893431ef1649af61a8e2d9b1812de", 1478812598, 0x01060000u },
        { 1340640, "00000000168dfce99d5fbab322c6d1bc1e3aa82963e4bec23f4293cfce2017ec", 1478941352, 0x01080000u },
        { 1342656, "000000001e6a457e806686516a88458cf0713de89e23d465b0ef95afa5dfd34d", 1479069038, 0x01060000u },
        { 1344672, "000000001097d6fefbb2df7d67d7df4db8de6604ee3d12305e05cbdbcfc91971", 1479195930, 0x010c0000u },
        { 1346688, "0000000016490247b06c7fcc79274f3ea1f3da9ed73a33e453fe3669d9b4de76", 1479323762, 0x01080000u },
        { 1348704, "000000002bdc1e489622c6ae1b73f2e959dd8867f2e0a71c6dc2bf0365f14669", 1479451465, 0x01050000u },
        { 1350720, "000000000e396b17f2c46d3044377475a640840a3b1f878502a4cc0c7644da47", 1479578848, 0x010e0000u },
        { 1352736, "000000001923898de4ac78ca29d732ffea2a597a13392f106923b8f39a5cdefb", 1479707422, 0x01060000u },
        { 1354752, "000000001126d203810909d972c48db50910dd2e90bc7ea3286743a7e25ab043", 1479834288, 0x010b0000u },
        { 1356768, "0000000011207fd22d2ad5a17f558718c02fd62bede11199b9894a3441ef9ff4", 1479962390, 0x01060000u },
        { 1358784, "00000000087c1b6ef451cb32e5b601791b6d3211fc8bb8648183f047d56df103", 1480090434, 0x01060000u },
        { 1360800, "000000002a857fb03781af2ada04daa2d1762d69838d2e682a3a6a06d8581f2e", 1480218651, 0x01040000u },
        { 1362816, "0000000027ee3997dc459dcf0955e9005421ab599484adcd44489e89603eaa0c", 1480345997, 0x01050000u },
        { 1364832, "000000000af0e5a6eb7d963fed0ab8d0e4e1f255ea399c89d82535c0cfaaf4fe", 1480473604, 0x01050000u }
    };
    
    static const char *dns_seeds[] = {
        "groestlcoin.org.", "electrum1.groestlcoin.org.", "electrum2.groestlcoin.org.", "jswallet.groestlcoin.org."
    };
    
#endif
    
    @interface BRPeerManager ()
    
    @property (nonatomic, strong) NSMutableOrderedSet *peers;
    @property (nonatomic, strong) NSMutableSet *connectedPeers, *misbehavinPeers, *nonFpTx;
    @property (nonatomic, strong) BRPeer *downloadPeer;
    @property (nonatomic, assign) uint32_t syncStartHeight, filterUpdateHeight;
    @property (nonatomic, strong) BRBloomFilter *bloomFilter;
    @property (nonatomic, assign) double fpRate;
    @property (nonatomic, assign) NSUInteger taskId, connectFailures, misbehavinCount;
    @property (nonatomic, assign) NSTimeInterval earliestKeyTime, lastRelayTime;
@property (nonatomic, strong) NSMutableDictionary *blocks, *orphans, *checkpoints, *txRelays, *txRequests;
@property (nonatomic, strong) NSMutableDictionary *publishedTx, *publishedCallback;
@property (nonatomic, strong) BRMerkleBlock *lastBlock, *lastOrphan;
@property (nonatomic, strong) dispatch_queue_t q;
@property (nonatomic, strong) id backgroundObserver, seedObserver;

@end

@implementation BRPeerManager

+ (instancetype)sharedInstance
{
    static id singleton = nil;
    static dispatch_once_t onceToken = 0;
    
    dispatch_once(&onceToken, ^{
        singleton = [self new];
    });
    
    return singleton;
}

- (instancetype)init
{
    if (! (self = [super init])) return nil;
    
    self.earliestKeyTime = [BRWalletManager sharedInstance].seedCreationTime;
    self.connectedPeers = [NSMutableSet set];
    self.misbehavinPeers = [NSMutableSet set];
    self.nonFpTx = [NSMutableSet set];
    self.taskId = UIBackgroundTaskInvalid;
    self.q = dispatch_queue_create("peermanager", NULL);
    self.orphans = [NSMutableDictionary dictionary];
    self.txRelays = [NSMutableDictionary dictionary];
    self.txRequests = [NSMutableDictionary dictionary];
    self.publishedTx = [NSMutableDictionary dictionary];
    self.publishedCallback = [NSMutableDictionary dictionary];
    
    self.backgroundObserver =
    [[NSNotificationCenter defaultCenter] addObserverForName:UIApplicationDidEnterBackgroundNotification object:nil
                                                       queue:nil usingBlock:^(NSNotification *note) {
                                                           [self savePeers];
                                                           [self saveBlocks];
                                                           
                                                           if (self.taskId == UIBackgroundTaskInvalid) {
                                                               self.misbehavinCount = 0;
                                                               [self.connectedPeers makeObjectsPerformSelector:@selector(disconnect)];
                                                           }
                                                       }];
    
    self.seedObserver =
    [[NSNotificationCenter defaultCenter] addObserverForName:BRWalletManagerSeedChangedNotification object:nil
                                                       queue:nil usingBlock:^(NSNotification *note) {
                                                           self.earliestKeyTime = [BRWalletManager sharedInstance].seedCreationTime;
                                                           self.syncStartHeight = 0;
                                                           [[NSUserDefaults standardUserDefaults] setInteger:0 forKey:SYNC_STARTHEIGHT_KEY];
                                                           [self.txRelays removeAllObjects];
                                                           [self.publishedTx removeAllObjects];
                                                           [self.publishedCallback removeAllObjects];
                                                           [BRMerkleBlockEntity deleteObjects:[BRMerkleBlockEntity allObjects]];
                                                           [BRMerkleBlockEntity saveContext];
                                                           _blocks = nil;
                                                           _bloomFilter = nil;
                                                           _lastBlock = nil;
                                                           [[self.connectedPeers copy] makeObjectsPerformSelector:@selector(disconnect)];
                                                       }];
    
    return self;
}

- (void)dealloc
{
    [NSObject cancelPreviousPerformRequestsWithTarget:self];
    if (self.backgroundObserver) [[NSNotificationCenter defaultCenter] removeObserver:self.backgroundObserver];
    if (self.seedObserver) [[NSNotificationCenter defaultCenter] removeObserver:self.seedObserver];
}

- (NSMutableOrderedSet *)peers
{
    if (_peers.count >= PEER_MAX_CONNECTIONS) return _peers;
    
    @synchronized(self) {
        if (_peers.count >= PEER_MAX_CONNECTIONS) return _peers;
        _peers = [NSMutableOrderedSet orderedSet];
        
        [[BRPeerEntity context] performBlockAndWait:^{
            for (BRPeerEntity *e in [BRPeerEntity allObjects]) {
                @autoreleasepool {
                    if (e.misbehavin == 0) [_peers addObject:[e peer]];
                    else [self.misbehavinPeers addObject:[e peer]];
                }
            }
        }];
        
        [self sortPeers];
        
        // DNS peer discovery
        NSTimeInterval now = [NSDate timeIntervalSinceReferenceDate];
        NSMutableArray *peers = [NSMutableArray arrayWithObject:[NSMutableArray array]];
        
        if (_peers.count < PEER_MAX_CONNECTIONS ||
            ((BRPeer *)_peers[PEER_MAX_CONNECTIONS - 1]).timestamp + 3*24*60*60 < now) {
            while (peers.count < sizeof(dns_seeds)/sizeof(*dns_seeds)) [peers addObject:[NSMutableArray array]];
        }
        
        if (peers.count > 0) {
            dispatch_apply(peers.count, dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^(size_t i) {
                NSString *servname = @(GROESTLCOIN_STANDARD_PORT).stringValue;
                struct addrinfo hints = { 0, AF_UNSPEC, SOCK_STREAM, 0, 0, 0, NULL, NULL }, *servinfo, *p;
                UInt128 addr = { .u32 = { 0, 0, CFSwapInt32HostToBig(0xffff), 0 } };
                
                NSLog(@"DNS lookup %s", dns_seeds[i]);
                
                if (getaddrinfo(dns_seeds[i], servname.UTF8String, &hints, &servinfo) == 0) {
                    for (p = servinfo; p != NULL; p = p->ai_next) {
                        if (p->ai_family == AF_INET) {
                            addr.u64[0] = 0;
                            addr.u32[2] = CFSwapInt32HostToBig(0xffff);
                            addr.u32[3] = ((struct sockaddr_in *)p->ai_addr)->sin_addr.s_addr;
                        }
                        //                        else if (p->ai_family == AF_INET6) {
                        //                            addr = *(UInt128 *)&((struct sockaddr_in6 *)p->ai_addr)->sin6_addr;
                        //                        }
                        else continue;
                        
                        uint16_t port = CFSwapInt16BigToHost(((struct sockaddr_in *)p->ai_addr)->sin_port);
                        NSTimeInterval age = 3*24*60*60 + arc4random_uniform(4*24*60*60); // add between 3 and 7 days
                        
                        [peers[i] addObject:[[BRPeer alloc] initWithAddress:addr port:port
                                                                  timestamp:(i > 0 ? now - age : now)
                                                                   services:SERVICES_NODE_NETWORK | SERVICES_NODE_BLOOM]];
                    }
                    
                    freeaddrinfo(servinfo);
                }
            });
            
            for (NSArray *a in peers) [_peers addObjectsFromArray:a];
            
#if GROESTLCOIN_TESTNET
            [self sortPeers];
            return _peers;
#endif
            // if DNS peer discovery fails, fall back on a hard coded list of peers (list taken from satoshi client)
            if (_peers.count < PEER_MAX_CONNECTIONS) {
                UInt128 addr = { .u32 = { 0, 0, CFSwapInt32HostToBig(0xffff), 0 } };
                
                for (NSNumber *address in [NSArray arrayWithContentsOfFile:[[NSBundle mainBundle]
                                                                            pathForResource:FIXED_PEERS ofType:@"plist"]]) {
                    // give hard coded peers a timestamp between 7 and 14 days ago
                    addr.u32[3] = CFSwapInt32HostToBig(address.unsignedIntValue);
                    [_peers addObject:[[BRPeer alloc] initWithAddress:addr port:GROESTLCOIN_STANDARD_PORT
                                                            timestamp:now - (7*24*60*60 + arc4random_uniform(7*24*60*60))
                                                             services:SERVICES_NODE_NETWORK | SERVICES_NODE_BLOOM]];
                }
            }
            
            [self sortPeers];
        }
        
        return _peers;
    }
}

- (NSMutableDictionary *)blocks
{
    if (_blocks.count > 0) return _blocks;
    
    [[BRMerkleBlockEntity context] performBlockAndWait:^{
        if (_blocks.count > 0) return;
        _blocks = [NSMutableDictionary dictionary];
        self.checkpoints = [NSMutableDictionary dictionary];
        
        for (int i = 0; i < CHECKPOINT_COUNT; i++) { // add checkpoints to the block collection
            UInt256 hash = *(UInt256 *)@(checkpoint_array[i].hash).hexToData.reverse.bytes;
            
            _blocks[uint256_obj(hash)] = [[BRMerkleBlock alloc] initWithBlockHash:hash version:1 prevBlock:UINT256_ZERO
                                                                       merkleRoot:UINT256_ZERO timestamp:checkpoint_array[i].timestamp
                                                                           target:checkpoint_array[i].target nonce:0 totalTransactions:0 hashes:nil
                                                                            flags:nil height:checkpoint_array[i].height];
            self.checkpoints[@(checkpoint_array[i].height)] = uint256_obj(hash);
        }
        
        for (BRMerkleBlockEntity *e in [BRMerkleBlockEntity allObjects]) {
            @autoreleasepool {
                BRMerkleBlock *b = e.merkleBlock;
                
                if (b) _blocks[uint256_obj(b.blockHash)] = b;
            }
        };
    }];
    
    return _blocks;
}

// this is used as part of a getblocks or getheaders request
- (NSArray *)blockLocatorArray
{
    // append 10 most recent block hashes, decending, then continue appending, doubling the step back each time,
    // finishing with the genesis block (top, -1, -2, -3, -4, -5, -6, -7, -8, -9, -11, -15, -23, -39, -71, -135, ..., 0)
    NSMutableArray *locators = [NSMutableArray array];
    int32_t step = 1, start = 0;
    BRMerkleBlock *b = self.lastBlock;
    
    while (b && b.height > 0) {
        [locators addObject:uint256_obj(b.blockHash)];
        if (++start >= 10) step *= 2;
        
        for (int32_t i = 0; b && i < step; i++) {
            b = self.blocks[uint256_obj(b.prevBlock)];
        }
    }
    
    [locators addObject:uint256_obj(GENESIS_BLOCK_HASH)];
    return locators;
}

- (BRMerkleBlock *)lastBlock
{
    if (! _lastBlock) {
        NSFetchRequest *req = [BRMerkleBlockEntity fetchReq];
        req.sortDescriptors = @[[NSSortDescriptor sortDescriptorWithKey:@"height" ascending:NO]];
        req.predicate = [NSPredicate predicateWithFormat:@"height >= 0 && height != %d", BLOCK_UNKNOWN_HEIGHT];
        req.fetchLimit = 1;
        _lastBlock = [[BRMerkleBlockEntity fetchObjects:req].lastObject merkleBlock];
        
        // if we don't have any blocks yet, use the latest checkpoint that's at least a week older than earliestKeyTime
        for (int i = CHECKPOINT_COUNT - 1; ! _lastBlock && i >= 0; i--) {
            if (i == 0 || checkpoint_array[i].timestamp + 7*24*60*60 < self.earliestKeyTime + NSTimeIntervalSince1970) {
                UInt256 hash = *(UInt256 *)@(checkpoint_array[i].hash).hexToData.reverse.bytes;
                
                _lastBlock = [[BRMerkleBlock alloc] initWithBlockHash:hash version:1 prevBlock:UINT256_ZERO
                                                           merkleRoot:UINT256_ZERO timestamp:checkpoint_array[i].timestamp
                                                               target:checkpoint_array[i].target nonce:0 totalTransactions:0 hashes:nil flags:nil
                                                               height:checkpoint_array[i].height];
            }
        }
        
        if (_lastBlock.height > _estimatedBlockHeight) _estimatedBlockHeight = _lastBlock.height;
    }
    
    return _lastBlock;
}

- (uint32_t)lastBlockHeight
{
    return self.lastBlock.height;
}

- (double)syncProgress
{
    if (! self.downloadPeer && self.syncStartHeight == 0) return 0.0;
    if (self.downloadPeer.status != BRPeerStatusConnected) return 0.05;
    if (self.lastBlockHeight >= self.estimatedBlockHeight) return 1.0;
    return 0.1 + 0.9*(self.lastBlockHeight - self.syncStartHeight)/(self.estimatedBlockHeight - self.syncStartHeight);
}

// number of connected peers
- (NSUInteger)peerCount
{
    NSUInteger count = 0;
    for (BRPeer *peer in [self.connectedPeers copy]) {
        if (peer.status == BRPeerStatusConnected) count++;
    }
    
    return count;
}

- (NSString *)downloadPeerName
{
    return [self.downloadPeer.host stringByAppendingFormat:@":%d", self.downloadPeer.port];
}

- (BRBloomFilter *)bloomFilterForPeer:(BRPeer *)peer
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    
    // every time a new wallet address is added, the bloom filter has to be rebuilt, and each address is only used for
    // one transaction, so here we generate some spare addresses to avoid rebuilding the filter each time a wallet
    // transaction is encountered during the blockchain download
    [manager.wallet addressesWithGapLimit:SEQUENCE_GAP_LIMIT_EXTERNAL + 100 internal:NO];
    [manager.wallet addressesWithGapLimit:SEQUENCE_GAP_LIMIT_INTERNAL + 100 internal:YES];
    
    [self.orphans removeAllObjects]; // clear out orphans that may have been received on an old filter
    self.lastOrphan = nil;
    self.filterUpdateHeight = self.lastBlockHeight;
    self.fpRate = BLOOM_REDUCED_FALSEPOSITIVE_RATE;
    
    BRUTXO o;
    NSData *d;
    NSSet *addresses = [manager.wallet.allReceiveAddresses setByAddingObjectsFromSet:manager.wallet.allChangeAddresses];
    NSUInteger i, elemCount = addresses.count + manager.wallet.unspentOutputs.count;
    NSMutableArray *inputs = [NSMutableArray new];


    for (BRTransaction *tx in manager.wallet.allTransactions) { // find TXOs spent within the last 100 blocks
        if (tx.blockHeight != TX_UNCONFIRMED && tx.blockHeight + 100 < self.lastBlockHeight) break;
        i = 0;
        
        for (NSValue *hash in tx.inputHashes) {
            [hash getValue:&o.hash];
            o.n = [tx.inputIndexes[i++] unsignedIntValue];
            
            BRTransaction *t = [manager.wallet transactionForHash:o.hash];
            
            if (o.n < t.outputAddresses.count && [manager.wallet containsAddress:t.outputAddresses[o.n]]) {
                [inputs addObject:brutxo_data(o)];
                elemCount++;
            }
        }
    }
    
    BRBloomFilter *filter = [[BRBloomFilter alloc] initWithFalsePositiveRate:self.fpRate
                             forElementCount:(elemCount < 200 ? 300 : elemCount + 100) tweak:(uint32_t)peer.hash
                             flags:BLOOM_UPDATE_ALL];

    for (NSString *addr in addresses) {// add addresses to watch for tx receiveing money to the wallet
        NSData *hash = addr.addressToHash160;

        if (hash && ! [filter containsData:hash]) [filter insertData:hash];
    }

    for (NSValue *utxo in manager.wallet.unspentOutputs) { // add UTXOs to watch for tx sending money from the wallet
        [utxo getValue:&o];
        d = brutxo_data(o);
        if (! [filter containsData:d]) [filter insertData:d];
    }
    
    for (d in inputs) { // also add TXOs spent within the last 100 blocks
        if (! [filter containsData:d]) [filter insertData:d];
    }

    // TODO: XXXX if already synced, recursively add inputs of unconfirmed receives
    _bloomFilter = filter;
    return _bloomFilter;
}

- (void)connect
{
    dispatch_async(self.q, ^{
        if ([BRWalletManager sharedInstance].noWallet) return; // check to make sure the wallet has been created
        if (self.connectFailures >= MAX_CONNECT_FAILURES) self.connectFailures = 0; // this attempt is a manual retry
        
        if (self.syncProgress < 1.0) {
            if (self.syncStartHeight == 0) {
                self.syncStartHeight = (uint32_t)[[NSUserDefaults standardUserDefaults]
                                                  integerForKey:SYNC_STARTHEIGHT_KEY];
            }
            
            if (self.syncStartHeight == 0) {
                self.syncStartHeight = self.lastBlockHeight;
                [[NSUserDefaults standardUserDefaults] setInteger:self.syncStartHeight forKey:SYNC_STARTHEIGHT_KEY];
            }
            
            if (self.taskId == UIBackgroundTaskInvalid) { // start a background task for the chain sync
                self.taskId =
                [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^{
                    dispatch_async(self.q, ^{
                        [self saveBlocks];
                    });
                    
                    [self syncStopped];
                }];
            }
            
            dispatch_async(dispatch_get_main_queue(), ^{
                [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerSyncStartedNotification
                                                                    object:nil];
            });
        }
        
        [self.connectedPeers minusSet:[self.connectedPeers objectsPassingTest:^BOOL(id obj, BOOL *stop) {
            return ([obj status] == BRPeerStatusDisconnected) ? YES : NO;
        }]];
        
        if (self.connectedPeers.count >= PEER_MAX_CONNECTIONS) return; //already connected to PEER_MAX_CONNECTIONS peers
        
        NSMutableOrderedSet *peers = [NSMutableOrderedSet orderedSetWithOrderedSet:self.peers];
        
        if (peers.count > 100) [peers removeObjectsInRange:NSMakeRange(100, peers.count - 100)];
        
        while (peers.count > 0 && self.connectedPeers.count < PEER_MAX_CONNECTIONS) {
            // pick a random peer biased towards peers with more recent timestamps
            BRPeer *p = peers[(NSUInteger)(pow(arc4random_uniform((uint32_t)peers.count), 2)/peers.count)];
            
            if (p && ! [self.connectedPeers containsObject:p]) {
                [p setDelegate:self queue:self.q];
                p.earliestKeyTime = self.earliestKeyTime;
                [self.connectedPeers addObject:p];
                [p connect];
            }
            
            [peers removeObject:p];
        }
        
        if (self.connectedPeers.count == 0) {
            [self syncStopped];
            
            dispatch_async(dispatch_get_main_queue(), ^{
                NSError *error = [NSError errorWithDomain:@"GroestlWallet" code:1
                                                 userInfo:@{NSLocalizedDescriptionKey:NSLocalizedString(@"no peers found", nil)}];
                
                [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerSyncFailedNotification
                                                                    object:nil userInfo:@{@"error":error}];
            });
        }
    });
}

// rescans blocks and transactions after earliestKeyTime, a new random download peer is also selected due to the
// possibility that a malicious node might lie by omitting transactions that match the bloom filter
- (void)rescan
{
    if (! self.connected) return;
    
    dispatch_async(self.q, ^{
        _lastBlock = nil;
        
        // start the chain download from the most recent checkpoint that's at least a week older than earliestKeyTime
        for (int i = CHECKPOINT_COUNT - 1; ! _lastBlock && i >= 0; i--) {
            if (i == 0 || checkpoint_array[i].timestamp + 7*24*60*60 < self.earliestKeyTime + NSTimeIntervalSince1970) {
                UInt256 hash = *(UInt256 *)@(checkpoint_array[i].hash).hexToData.reverse.bytes;
                
                _lastBlock = self.blocks[uint256_obj(hash)];
            }
        }
        
        if (self.downloadPeer) { // disconnect the current download peer so a new random one will be selected
            [self.peers removeObject:self.downloadPeer];
            [self.downloadPeer disconnect];
        }
        
        self.syncStartHeight = self.lastBlockHeight;
        [[NSUserDefaults standardUserDefaults] setInteger:self.syncStartHeight forKey:SYNC_STARTHEIGHT_KEY];
        [self connect];
    });
}

// adds transaction to list of tx to be published, along with any unconfirmed inputs
- (void)addTransactionToPublishList:(BRTransaction *)transaction
{
    NSLog(@"[BRPeerManager] add transaction to publish list %@", transaction);
    if (transaction.blockHeight == TX_UNCONFIRMED) {
        self.publishedTx[uint256_obj(transaction.txHash)] = transaction;
        
        for (NSValue *hash in transaction.inputHashes) {
            UInt256 h = UINT256_ZERO;
            
            [hash getValue:&h];
            [self addTransactionToPublishList:[[BRWalletManager sharedInstance].wallet transactionForHash:h]];
        }
    }
}

- (void)publishTransaction:(BRTransaction *)transaction completion:(void (^)(NSError *error))completion
{
    NSLog(@"[BRPeerManager] publish transaction %@", transaction);
    if (! transaction.isSigned) {
        if (completion) {
            [[BREventManager sharedEventManager] saveEvent:@"peer_manager:not_signed"];
            completion([NSError errorWithDomain:@"GroestlWallet" code:401 userInfo:@{NSLocalizedDescriptionKey:
                                                                                       NSLocalizedString(@"groestlcoin transaction not signed", nil)}]);
        }
        
        return;
    }
    else if (! self.connected && self.connectFailures >= MAX_CONNECT_FAILURES) {
        if (completion) {
            [[BREventManager sharedEventManager] saveEvent:@"peer_manager:not_connected"];
            completion([NSError errorWithDomain:@"GroestlWallet" code:-1009 userInfo:@{NSLocalizedDescriptionKey:
                                                                                         NSLocalizedString(@"not connected to the groestlcoin network", nil)}]);
        }
        
        return;
    }
    
    NSMutableSet *peers = [NSMutableSet setWithSet:self.connectedPeers];
    NSValue *hash = uint256_obj(transaction.txHash);
    
    [self addTransactionToPublishList:transaction];
    if (completion) self.publishedCallback[hash] = completion;
    
    NSArray *txHashes = self.publishedTx.allKeys;
    
    // instead of publishing to all peers, leave out the download peer to see if the tx propogates and gets relayed back
    // TODO: XXX connect to a random peer with an empty or fake bloom filter just for publishing
    if (self.peerCount > 1 && self.downloadPeer) [peers removeObject:self.downloadPeer];
    
    dispatch_async(dispatch_get_main_queue(), ^{
        [self performSelector:@selector(txTimeout:) withObject:hash afterDelay:PROTOCOL_TIMEOUT];
        
        for (BRPeer *p in peers) {
            [p sendInvMessageWithTxHashes:txHashes];
            [p sendPingMessageWithPongHandler:^(BOOL success) {
                if (! success) return;
                
                for (NSValue *h in txHashes) {
                    if ([self.txRelays[h] containsObject:p] || [self.txRequests[h] containsObject:p]) continue;
                    if (! self.txRequests[h]) self.txRequests[h] = [NSMutableSet set];
                    [self.txRequests[h] addObject:p];
                    [p sendGetdataMessageWithTxHashes:@[h] andBlockHashes:nil];
                }
            }];
        }
    });
}

// number of connected peers that have relayed the transaction
- (NSUInteger)relayCountForTransaction:(UInt256)txHash
{
    return [self.txRelays[uint256_obj(txHash)] count];
}

// seconds since reference date, 00:00:00 01/01/01 GMT
// NOTE: this is only accurate for the last two weeks worth of blocks, other timestamps are estimated from checkpoints
- (NSTimeInterval)timestampForBlockHeight:(uint32_t)blockHeight
{
    if (blockHeight == TX_UNCONFIRMED) return (self.lastBlock.timestamp - NSTimeIntervalSince1970) + 60; //next block
    
    if (blockHeight >= self.lastBlockHeight) { // future block, assume 1 minute per block after last block
        return (self.lastBlock.timestamp - NSTimeIntervalSince1970) + (blockHeight - self.lastBlockHeight)*60;
    }
    
    if (_blocks.count > 0) {
        if (blockHeight >= self.lastBlockHeight - DGW_PAST_BLOCKS_MAX) { // recent block we have the header for
            BRMerkleBlock *block = self.lastBlock;
            
            while (block && block.height > blockHeight) block = self.blocks[uint256_obj(block.prevBlock)];
            if (block) return block.timestamp - NSTimeIntervalSince1970;
        }
    }
    else [[BRMerkleBlockEntity context] performBlock:^{ [self blocks]; }];
    
    uint32_t h = self.lastBlockHeight, t = self.lastBlock.timestamp;
    
    for (int i = CHECKPOINT_COUNT - 1; i >= 0; i--) { // estimate from checkpoints
        if (checkpoint_array[i].height <= blockHeight) {
            t = checkpoint_array[i].timestamp + (t - checkpoint_array[i].timestamp)*
            (blockHeight - checkpoint_array[i].height)/(h - checkpoint_array[i].height);
            return t - NSTimeIntervalSince1970;
        }
        
        h = checkpoint_array[i].height;
        t = checkpoint_array[i].timestamp;
    }
    
    return checkpoint_array[0].timestamp - NSTimeIntervalSince1970;
}

- (void)setBlockHeight:(int32_t)height andTimestamp:(NSTimeInterval)timestamp forTxHashes:(NSArray *)txHashes
{
    NSArray *updatedTx = [[BRWalletManager sharedInstance].wallet setBlockHeight:height andTimestamp:timestamp
                          forTxHashes:txHashes];
    
    if (height != TX_UNCONFIRMED) { // remove confirmed tx from publish list and relay counts
        [self.publishedTx removeObjectsForKeys:txHashes];
        [self.publishedCallback removeObjectsForKeys:txHashes];
        [self.txRelays removeObjectsForKeys:txHashes];
    }
    
    for (NSValue *hash in updatedTx) {
        NSError *kvErr = nil;
        BRTxMetadataObject *txm;
        UInt256 h;
        
        [hash getValue:&h];
        txm = [[BRTxMetadataObject alloc] initWithTxHash:h store:[BRAPIClient sharedClient].kv];
        txm.blockHeight = height;
        if (txm) [[BRAPIClient sharedClient].kv set:txm error:&kvErr];
    }
}

- (void)txTimeout:(NSValue *)txHash
{
    void (^callback)(NSError *error) = self.publishedCallback[txHash];
    
    [self.publishedTx removeObjectForKey:txHash];
    [self.publishedCallback removeObjectForKey:txHash];
    [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(txTimeout:) object:txHash];
    
    if (callback) {
        [[BREventManager sharedEventManager] saveEvent:@"peer_manager:tx_canceled_timeout"];
        callback([NSError errorWithDomain:@"GroestlWallet" code:BITCOIN_TIMEOUT_CODE userInfo:@{NSLocalizedDescriptionKey:
                                                                                                  NSLocalizedString(@"transaction canceled, network timeout", nil)}]);
    }
}

- (void)syncTimeout
{
    NSTimeInterval now = [NSDate timeIntervalSinceReferenceDate];
    
    if (now - self.lastRelayTime < PROTOCOL_TIMEOUT) { // the download peer relayed something in time, so restart timer
        [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(syncTimeout) object:nil];
        [self performSelector:@selector(syncTimeout) withObject:nil
                   afterDelay:PROTOCOL_TIMEOUT - (now - self.lastRelayTime)];
        return;
    }
    
    dispatch_async(self.q, ^{
        if (! self.downloadPeer) return;
        NSLog(@"%@:%d chain sync timed out", self.downloadPeer.host, self.downloadPeer.port);
        [self.peers removeObject:self.downloadPeer];
        [self.downloadPeer disconnect];
    });
}

- (void)syncStopped
{
    dispatch_async(dispatch_get_main_queue(), ^{
        [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(syncTimeout) object:nil];
        
        if (self.taskId != UIBackgroundTaskInvalid) {
            [[UIApplication sharedApplication] endBackgroundTask:self.taskId];
            self.taskId = UIBackgroundTaskInvalid;
        }
    });
}

- (void)loadMempools
{
    NSArray *txHashes = self.publishedTx.allKeys;
    
    for (BRPeer *p in self.connectedPeers) { // after syncing, load filters and get mempools from other peers
        if (p != self.downloadPeer || self.fpRate > BLOOM_REDUCED_FALSEPOSITIVE_RATE*5.0) {
            [p sendFilterloadMessage:[self bloomFilterForPeer:p].data];
        }
        
        [p sendInvMessageWithTxHashes:txHashes]; // publish unconfirmed tx
        [p sendPingMessageWithPongHandler:^(BOOL success) {
            if (success) {
                [p sendMempoolMessage];
                [p sendPingMessageWithPongHandler:^(BOOL success) {
                    if (success) {
                        p.synced = YES;
                        [self removeUnrelayedTransactions];
                        [p sendGetaddrMessage]; // request a list of other groestlcoin peers
                    }
                    
                    if (p == self.downloadPeer) {
                        [self syncStopped];
                        
                        dispatch_async(dispatch_get_main_queue(), ^{
                            [[NSNotificationCenter defaultCenter]
                             postNotificationName:BRPeerManagerSyncFinishedNotification object:nil];
                        });
                    }
                }];
            }
            else if (p == self.downloadPeer) {
                [self syncStopped];
                
                dispatch_async(dispatch_get_main_queue(), ^{
                    [[NSNotificationCenter defaultCenter]
                     postNotificationName:BRPeerManagerSyncFinishedNotification object:nil];
                });
            }
        }];
    }
}

// unconfirmed transactions that aren't in the mempools of any of connected peers have likely dropped off the network
- (void)removeUnrelayedTransactions
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    BOOL rescan = NO, notify = NO;
    NSValue *hash;
    UInt256 h;
    
    // don't remove transactions until we're connected to PEER_MAX_CONNECTION peers
    if (self.connectedPeers.count < PEER_MAX_CONNECTIONS) return;
    
    for (BRPeer *p in self.connectedPeers) { // don't remove tx until all peers have finished relaying their mempools
        if (! p.synced) return;
    }
    
    for (BRTransaction *tx in manager.wallet.allTransactions) {
        if (tx.blockHeight != TX_UNCONFIRMED) break;
        hash = uint256_obj(tx.txHash);
        if (self.publishedCallback[hash] != NULL) continue;
        
        if ([self.txRelays[hash] count] == 0 && [self.txRequests[hash] count] == 0) {
            // if this is for a transaction we sent, and it wasn't already known to be invalid, notify user of failure
            if (! rescan && [manager.wallet amountSentByTransaction:tx] > 0 && [manager.wallet transactionIsValid:tx]) {
                NSLog(@"failed transaction %@", tx);
                rescan = notify = YES;
                
                for (NSValue *hash in tx.inputHashes) { // only recommend a rescan if all inputs are confirmed
                    [hash getValue:&h];
                    if ([manager.wallet transactionForHash:h].blockHeight != TX_UNCONFIRMED) continue;
                    rescan = NO;
                    break;
                }
            }
            
            [manager.wallet removeTransaction:tx.txHash];
        }
        else if ([self.txRelays[hash] count] < PEER_MAX_CONNECTIONS) {
            // set timestamp 0 to mark as unverified
            [self setBlockHeight:TX_UNCONFIRMED andTimestamp:0 forTxHashes:@[hash]];
        }
    }
    
    if (notify) {
        dispatch_async(dispatch_get_main_queue(), ^{
            if (rescan) {
                [[BREventManager sharedEventManager] saveEvent:@"peer_manager:tx_rejected_rescan"];
                [[[UIAlertView alloc] initWithTitle:NSLocalizedString(@"transaction rejected", nil)
                                            message:NSLocalizedString(@"Your wallet may be out of sync.\n"
                                                                      "This can often be fixed by rescanning the blockchain.", nil) delegate:self
                                  cancelButtonTitle:NSLocalizedString(@"cancel", nil)
                                  otherButtonTitles:NSLocalizedString(@"rescan", nil), nil] show];
            }
            else {
                [[BREventManager sharedEventManager] saveEvent:@"peer_manager_tx_rejected"];
                [[[UIAlertView alloc] initWithTitle:NSLocalizedString(@"transaction rejected", nil)
                                            message:nil delegate:nil cancelButtonTitle:NSLocalizedString(@"ok", nil) otherButtonTitles:nil] show];
            }
        });
    }
}

- (void)updateFilter
{
    if (self.downloadPeer.needsFilterUpdate) return;
    self.downloadPeer.needsFilterUpdate = YES;
    NSLog(@"filter update needed, waiting for pong");
    
    [self.downloadPeer sendPingMessageWithPongHandler:^(BOOL success) { // wait for pong so we include already sent tx
        if (! success) return;
        NSLog(@"updating filter with newly created wallet addresses");
        _bloomFilter = nil;
        
        if (self.lastBlockHeight < self.estimatedBlockHeight) { // if we're syncing, only update download peer
            [self.downloadPeer sendFilterloadMessage:[self bloomFilterForPeer:self.downloadPeer].data];
            [self.downloadPeer sendPingMessageWithPongHandler:^(BOOL success) { // wait for pong so filter is loaded
                if (! success) return;
                self.downloadPeer.needsFilterUpdate = NO;
                [self.downloadPeer rerequestBlocksFrom:self.lastBlock.blockHash];
                [self.downloadPeer sendPingMessageWithPongHandler:^(BOOL success) {
                    if (! success || self.downloadPeer.needsFilterUpdate) return;
                    [self.downloadPeer sendGetblocksMessageWithLocators:[self blockLocatorArray]
                                                            andHashStop:UINT256_ZERO];
                }];
            }];
        }
        else {
            for (BRPeer *p in self.connectedPeers) {
                [p sendFilterloadMessage:[self bloomFilterForPeer:p].data];
                [p sendPingMessageWithPongHandler:^(BOOL success) { // wait for pong so we know filter is loaded
                    if (! success) return;
                    p.needsFilterUpdate = NO;
                    [p sendMempoolMessage];
                }];
            }
        }
    }];
}

- (void)peerMisbehavin:(BRPeer *)peer
{
    peer.misbehavin++;
    [self.peers removeObject:peer];
    [self.misbehavinPeers addObject:peer];
    
    if (++self.misbehavinCount >= 10) { // clear out stored peers so we get a fresh list from DNS for next connect
        self.misbehavinCount = 0;
        [self.misbehavinPeers removeAllObjects];
        [BRPeerEntity deleteObjects:[BRPeerEntity allObjects]];
        _peers = nil;
    }
    
    [peer disconnect];
    [self connect];
}

- (void)sortPeers
{
    [_peers sortUsingComparator:^NSComparisonResult(BRPeer *p1, BRPeer *p2) {
        if (p1.timestamp > p2.timestamp) return NSOrderedAscending;
        if (p1.timestamp < p2.timestamp) return NSOrderedDescending;
        return NSOrderedSame;
    }];
}

- (void)savePeers
{
    NSLog(@"[BRPeerManager] save peers");
    NSMutableSet *peers = [[self.peers.set setByAddingObjectsFromSet:self.misbehavinPeers] mutableCopy];
    NSMutableSet *addrs = [NSMutableSet set];
    
    for (BRPeer *p in peers) {
        if (p.address.u64[0] != 0 || p.address.u32[2] != CFSwapInt32HostToBig(0xffff)) continue; // skip IPv6 for now
        [addrs addObject:@(CFSwapInt32BigToHost(p.address.u32[3]))];
    }
    
    [[BRPeerEntity context] performBlock:^{
        [BRPeerEntity deleteObjects:[BRPeerEntity objectsMatching:@"! (address in %@)", addrs]]; // remove deleted peers
        
        for (BRPeerEntity *e in [BRPeerEntity objectsMatching:@"address in %@", addrs]) { // update existing peers
            @autoreleasepool {
                BRPeer *p = [peers member:[e peer]];
                
                if (p) {
                    e.timestamp = p.timestamp;
                    e.services = p.services;
                    e.misbehavin = p.misbehavin;
                    [peers removeObject:p];
                }
                else [e deleteObject];
            }
        }
        
        for (BRPeer *p in peers) {
            @autoreleasepool {
                [[BRPeerEntity managedObject] setAttributesFromPeer:p]; // add new peers
            }
        }
    }];
}

- (void)saveBlocks
{
    NSLog(@"[BRPeerManager] save blocks");
    NSMutableDictionary *blocks = [NSMutableDictionary dictionary];
    BRMerkleBlock *b = self.lastBlock;
    
    while (b) {
        blocks[[NSData dataWithBytes:b.blockHash.u8 length:sizeof(UInt256)]] = b;
        b = self.blocks[uint256_obj(b.prevBlock)];
    }
    
    [[BRMerkleBlockEntity context] performBlock:^{
        [BRMerkleBlockEntity deleteObjects:[BRMerkleBlockEntity objectsMatching:@"! (blockHash in %@)",
                                            blocks.allKeys]];
        
        for (BRMerkleBlockEntity *e in [BRMerkleBlockEntity objectsMatching:@"blockHash in %@", blocks.allKeys]) {
            @autoreleasepool {
                [e setAttributesFromBlock:blocks[e.blockHash]];
                [blocks removeObjectForKey:e.blockHash];
            }
        }
        
        for (BRMerkleBlock *b in blocks.allValues) {
            @autoreleasepool {
                [[BRMerkleBlockEntity managedObject] setAttributesFromBlock:b];
            }
        }
        
        [BRMerkleBlockEntity saveContext];
    }];
}

// MARK: - BRPeerDelegate

- (void)peerConnected:(BRPeer *)peer
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    NSTimeInterval now = [NSDate timeIntervalSinceReferenceDate];
    
    if (peer.timestamp > now + 2*60*60 || peer.timestamp < now - 2*60*60) peer.timestamp = now; //timestamp sanity check
    self.connectFailures = 0;
    NSLog(@"%@:%d connected with lastblock %d", peer.host, peer.port, peer.lastblock);
    
    // drop peers that don't carry full blocks, or aren't synced yet
    // TODO: XXXX does this work with 0.11 pruned nodes?
    if (! (peer.services & SERVICES_NODE_NETWORK) || peer.lastblock + 10 < self.lastBlockHeight) {
        [peer disconnect];
        return;
    }
    
    // drop peers that don't support SPV filtering
    if (peer.version >= 70011 && ! (peer.services & SERVICES_NODE_BLOOM)) {
        [peer disconnect];
        return;
    }


    dispatch_async(dispatch_get_main_queue(), ^{
        [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerTxStatusNotification object:nil];
    });


    for (BRTransaction *tx in manager.wallet.allTransactions) {
        if (tx.blockHeight != TX_UNCONFIRMED) break;
        
        if ([manager.wallet amountSentByTransaction:tx] > 0 && [manager.wallet transactionIsValid:tx]) {
            [self addTransactionToPublishList:tx]; // add unconfirmed valid send tx to mempool
        }
    }
    
    if (self.connected && (self.estimatedBlockHeight >= peer.lastblock || self.lastBlockHeight >= peer.lastblock)) {
        if (self.lastBlockHeight < self.estimatedBlockHeight) return; // don't load bloom filter yet if we're syncing
        [peer sendFilterloadMessage:[self bloomFilterForPeer:peer].data];
        [peer sendInvMessageWithTxHashes:self.publishedTx.allKeys]; // publish unconfirmed tx
        [peer sendPingMessageWithPongHandler:^(BOOL success) {
            [peer sendMempoolMessage];
            [peer sendPingMessageWithPongHandler:^(BOOL success) {
                if (! success) return;
                peer.synced = YES;
                [self removeUnrelayedTransactions];
                [peer sendGetaddrMessage]; // request a list of other groestlcoin peers
            }];
        }];
        
        return; // we're already connected to a download peer
    }
    
    // select the peer with the lowest ping time to download the chain from if we're behind
    // BUG: XXX a malicious peer can report a higher lastblock to make us select them as the download peer, if two
    // peers agree on lastblock, use one of them instead
    for (BRPeer *p in self.connectedPeers) {
        if ((p.pingTime < peer.pingTime && p.lastblock >= peer.lastblock) || p.lastblock > peer.lastblock) peer = p;
    }
    
    [self.downloadPeer disconnect];
    self.downloadPeer = peer;
    _connected = YES;
    _estimatedBlockHeight = peer.lastblock;
    [peer sendFilterloadMessage:[self bloomFilterForPeer:peer].data];
    peer.currentBlockHeight = self.lastBlockHeight;
    
    if (self.lastBlockHeight < peer.lastblock) { // start blockchain sync
        self.lastRelayTime = 0;
        
        dispatch_async(dispatch_get_main_queue(), ^{ // setup a timer to detect if the sync stalls
            [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(syncTimeout) object:nil];
            [self performSelector:@selector(syncTimeout) withObject:nil afterDelay:PROTOCOL_TIMEOUT];
            
            dispatch_async(self.q, ^{
                // request just block headers up to a week before earliestKeyTime, and then merkleblocks after that
                // BUG: XXX headers can timeout on slow connections (each message is over 160k)
                if (self.lastBlock.timestamp + 7*24*60*60 >= self.earliestKeyTime + NSTimeIntervalSince1970) {
                    [peer sendGetblocksMessageWithLocators:[self blockLocatorArray] andHashStop:UINT256_ZERO];
                }
                else [peer sendGetheadersMessageWithLocators:[self blockLocatorArray] andHashStop:UINT256_ZERO];
            });
        });
    }
    else { // we're already synced
        self.syncStartHeight = 0;
        [[NSUserDefaults standardUserDefaults] setInteger:0 forKey:SYNC_STARTHEIGHT_KEY];
        [self loadMempools];
    }
}

- (void)peer:(BRPeer *)peer disconnectedWithError:(NSError *)error
{
    NSLog(@"%@:%d disconnected%@%@", peer.host, peer.port, (error ? @", " : @""), (error ? error : @""));
    
    if ([error.domain isEqual:@"BreadWallet"] && error.code != BITCOIN_TIMEOUT_CODE) {
        [self peerMisbehavin:peer]; // if it's protocol error other than timeout, the peer isn't following the rules
    }
    else if (error) { // timeout or some non-protocol related network error
        [self.peers removeObject:peer];
        self.connectFailures++;
    }
    
    for (NSValue *txHash in self.txRelays.allKeys) {
        [self.txRelays[txHash] removeObject:peer];
    }
    
    if ([self.downloadPeer isEqual:peer]) { // download peer disconnected
        _connected = NO;
        self.downloadPeer = nil;
        if (self.connectFailures > MAX_CONNECT_FAILURES) self.connectFailures = MAX_CONNECT_FAILURES;
    }
    
    if (! self.connected && self.connectFailures == MAX_CONNECT_FAILURES) {
        [self syncStopped];
        
        // clear out stored peers so we get a fresh list from DNS on next connect attempt
        [self.misbehavinPeers removeAllObjects];
        [BRPeerEntity deleteObjects:[BRPeerEntity allObjects]];
        _peers = nil;
        
        dispatch_async(dispatch_get_main_queue(), ^{
            [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerSyncFailedNotification
                                                                object:nil userInfo:(error) ? @{@"error":error} : nil];
        });
    }
    else if (self.connectFailures < MAX_CONNECT_FAILURES && (self.taskId != UIBackgroundTaskInvalid ||
                                                             [UIApplication sharedApplication].applicationState != UIApplicationStateBackground)) {
        [self connect]; // try connecting to another peer
    }
    
    dispatch_async(dispatch_get_main_queue(), ^{
        [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerTxStatusNotification object:nil];
    });
}

- (void)peer:(BRPeer *)peer relayedPeers:(NSArray *)peers
{
    NSLog(@"%@:%d relayed %d peer(s)", peer.host, peer.port, (int)peers.count);
    [self.peers addObjectsFromArray:peers];
    [self.peers minusSet:self.misbehavinPeers];
    [self sortPeers];
    
    // limit total to 2500 peers
    if (self.peers.count > 2500) [self.peers removeObjectsInRange:NSMakeRange(2500, self.peers.count - 2500)];
    
    NSTimeInterval now = [NSDate timeIntervalSinceReferenceDate];
    
    // remove peers more than 3 hours old, or until there are only 1000 left
    while (self.peers.count > 1000 && ((BRPeer *)self.peers.lastObject).timestamp + 3*60*60 < now) {
        [self.peers removeObject:self.peers.lastObject];
    }
    
    if (peers.count > 1 && peers.count < 1000) [self savePeers]; // peer relaying is complete when we receive <1000
}

- (void)peer:(BRPeer *)peer relayedTransaction:(BRTransaction *)transaction
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    NSValue *hash = uint256_obj(transaction.txHash);
    BOOL syncing = (self.lastBlockHeight < self.estimatedBlockHeight);
    void (^callback)(NSError *error) = self.publishedCallback[hash];
    
    NSLog(@"%@:%d relayed transaction %@", peer.host, peer.port, hash);
    
    transaction.timestamp = [NSDate timeIntervalSinceReferenceDate];
    if (syncing && ! [manager.wallet containsTransaction:transaction]) return;
    if (! [manager.wallet registerTransaction:transaction]) return;
    if (peer == self.downloadPeer) self.lastRelayTime = [NSDate timeIntervalSinceReferenceDate];
    
    if ([manager.wallet amountSentByTransaction:transaction] > 0 && [manager.wallet transactionIsValid:transaction]) {
        [self addTransactionToPublishList:transaction]; // add valid send tx to mempool
    }
    
    // keep track of how many peers have or relay a tx, this indicates how likely the tx is to confirm
    if (callback || (! syncing && ! [self.txRelays[hash] containsObject:peer])) {
        if (! self.txRelays[hash]) self.txRelays[hash] = [NSMutableSet set];
        [self.txRelays[hash] addObject:peer];
        if (callback) [self.publishedCallback removeObjectForKey:hash];
        
        if ([self.txRelays[hash] count] >= PEER_MAX_CONNECTIONS &&
            [manager.wallet transactionForHash:transaction.txHash].blockHeight == TX_UNCONFIRMED &&
            [manager.wallet transactionForHash:transaction.txHash].timestamp == 0) {
            [self setBlockHeight:TX_UNCONFIRMED andTimestamp:[NSDate timeIntervalSinceReferenceDate]
                     forTxHashes:@[hash]]; // set timestamp when tx is verified
        }
        
        dispatch_async(dispatch_get_main_queue(), ^{
            NSError *kvErr = nil;
            
            [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(txTimeout:) object:hash];
            [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerTxStatusNotification object:nil];
            if (callback) callback(nil);
            
            [[BRAPIClient sharedClient].kv
             set:[[BRTxMetadataObject alloc] initWithTransaction:transaction exchangeRate:manager.localCurrencyPrice
                  exchangeRateCurrency:manager.localCurrencyCode feeRate:manager.wallet.feePerKb
                  deviceId:[BRAPIClient sharedClient].deviceId] error:&kvErr];
        });
    }
    
    [self.nonFpTx addObject:hash];
    [self.txRequests[hash] removeObject:peer];
    if (! _bloomFilter) return; // bloom filter is aready being updated
    
    // the transaction likely consumed one or more wallet addresses, so check that at least the next <gap limit>
    // unused addresses are still matched by the bloom filter
    NSArray *external = [manager.wallet addressesWithGapLimit:SEQUENCE_GAP_LIMIT_EXTERNAL internal:NO],

            *internal = [manager.wallet addressesWithGapLimit:SEQUENCE_GAP_LIMIT_INTERNAL internal:YES];

    for (NSString *address in [external arrayByAddingObjectsFromArray:internal]) {
        NSData *hash = address.addressToHash160;
        
        if (! hash || [_bloomFilter containsData:hash]) continue;
        _bloomFilter = nil; // reset bloom filter so it's recreated with new wallet addresses
        [self updateFilter];
        break;
    }
}

- (void)peer:(BRPeer *)peer hasTransaction:(UInt256)txHash
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    NSValue *hash = uint256_obj(txHash);
    BOOL syncing = (self.lastBlockHeight < self.estimatedBlockHeight);
    BRTransaction *tx = self.publishedTx[hash];
    void (^callback)(NSError *error) = self.publishedCallback[hash];
    
    NSLog(@"%@:%d has transaction %@", peer.host, peer.port, hash);
    if (! tx) tx = [manager.wallet transactionForHash:txHash];
    if (! tx || (syncing && ! [manager.wallet containsTransaction:tx])) return;
    if (! [manager.wallet registerTransaction:tx]) return;
    if (peer == self.downloadPeer) self.lastRelayTime = [NSDate timeIntervalSinceReferenceDate];
    
    // keep track of how many peers have or relay a tx, this indicates how likely the tx is to confirm
    if (callback || (! syncing && ! [self.txRelays[hash] containsObject:peer])) {
        if (! self.txRelays[hash]) self.txRelays[hash] = [NSMutableSet set];
        [self.txRelays[hash] addObject:peer];
        if (callback) [self.publishedCallback removeObjectForKey:hash];
        
        if ([self.txRelays[hash] count] >= PEER_MAX_CONNECTIONS &&
            [manager.wallet transactionForHash:txHash].blockHeight == TX_UNCONFIRMED &&
            [manager.wallet transactionForHash:txHash].timestamp == 0) {
            [self setBlockHeight:TX_UNCONFIRMED andTimestamp:[NSDate timeIntervalSinceReferenceDate]
                     forTxHashes:@[hash]]; // set timestamp when tx is verified
        }
        
        dispatch_async(dispatch_get_main_queue(), ^{
            NSError *kvErr = nil;
            
            [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(txTimeout:) object:hash];
            [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerTxStatusNotification object:nil];
            if (callback) callback(nil);

            [[BRAPIClient sharedClient].kv
             set:[[BRTxMetadataObject alloc] initWithTransaction:tx exchangeRate:manager.localCurrencyPrice
                  exchangeRateCurrency:manager.localCurrencyCode feeRate:manager.wallet.feePerKb
                  deviceId:[BRAPIClient sharedClient].deviceId] error:&kvErr];
        });
    }
    
    [self.nonFpTx addObject:hash];
    [self.txRequests[hash] removeObject:peer];
}

- (void)peer:(BRPeer *)peer rejectedTransaction:(UInt256)txHash withCode:(uint8_t)code
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    BRTransaction *tx = [manager.wallet transactionForHash:txHash];
    NSValue *hash = uint256_obj(txHash);
    
    if ([self.txRelays[hash] containsObject:peer]) {
        [self.txRelays[hash] removeObject:peer];
        
        if (tx.blockHeight == TX_UNCONFIRMED) { // set timestamp 0 for unverified
            [self setBlockHeight:TX_UNCONFIRMED andTimestamp:0 forTxHashes:@[hash]];
        }
        
        dispatch_async(dispatch_get_main_queue(), ^{
            [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerTxStatusNotification object:nil];
#if DEBUG
            [[[UIAlertView alloc] initWithTitle:@"transaction rejected"
                                        message:[NSString stringWithFormat:@"rejected by %@:%d with code 0x%x", peer.host, peer.port, code]
                                       delegate:nil cancelButtonTitle:@"ok" otherButtonTitles:nil] show];
#endif
        });
    }
    
    [self.txRequests[hash] removeObject:peer];
    
    // if we get rejected for any reason other than double-spend, the peer is likely misconfigured
    if (code != REJECT_SPENT && [manager.wallet amountSentByTransaction:tx] > 0) {
        for (hash in tx.inputHashes) { // check that all inputs are confirmed before dropping peer
            UInt256 h = UINT256_ZERO;
            
            [hash getValue:&h];
            if ([manager.wallet transactionForHash:h].blockHeight == TX_UNCONFIRMED) return;
        }
        
        [self peerMisbehavin:peer];
    }
}

- (void)peer:(BRPeer *)peer relayedBlock:(BRMerkleBlock *)block
{
    // ignore block headers that are newer than one week before earliestKeyTime (headers have 0 totalTransactions)
    if (block.totalTransactions == 0 &&
        block.timestamp + 7*24*60*60 > self.earliestKeyTime + NSTimeIntervalSince1970 + 2*60*60) return;
    
    NSArray *txHashes = block.txHashes;
    
    // track the observed bloom filter false positive rate using a low pass filter to smooth out variance
    if (peer == self.downloadPeer && block.totalTransactions > 0) {
        NSMutableSet *fp = [NSMutableSet setWithArray:txHashes];

        // 1% low pass filter, also weights each block by total transactions, using 1400 tx per block as typical
        [fp minusSet:self.nonFpTx]; // wallet tx are not false-positives
        [self.nonFpTx removeAllObjects];
        self.fpRate = self.fpRate*(1.0 - 0.01*block.totalTransactions/1400) + 0.01*fp.count/1400;

        // false positive rate sanity check
        if (self.downloadPeer.status == BRPeerStatusConnected && self.fpRate > BLOOM_DEFAULT_FALSEPOSITIVE_RATE*10.0) {
            NSLog(@"%@:%d bloom filter false positive rate %f too high after %d blocks, disconnecting...", peer.host,
                  peer.port, self.fpRate, self.lastBlockHeight + 1 - self.filterUpdateHeight);
            [self.downloadPeer disconnect];
        }
        else if (self.lastBlockHeight + 500 < peer.lastblock && self.fpRate > BLOOM_REDUCED_FALSEPOSITIVE_RATE*10.0) {
            [self updateFilter]; // rebuild bloom filter when it starts to degrade
        }
    }
    
    if (! _bloomFilter) { // ingore potentially incomplete blocks when a filter update is pending
        if (peer == self.downloadPeer) self.lastRelayTime = [NSDate timeIntervalSinceReferenceDate];
        return;
    }
    
    NSValue *blockHash = uint256_obj(block.blockHash), *prevBlock = uint256_obj(block.prevBlock);
    BRMerkleBlock *prev = self.blocks[prevBlock];
    uint32_t txTime = 0;
    UInt256 checkpoint = UINT256_ZERO;
    BOOL syncDone = NO;
    
    if (! prev) { // block is an orphan
        NSLog(@"%@:%d relayed orphan block %@, previous %@, last block is %@, height %d", peer.host, peer.port,
              blockHash, prevBlock, uint256_obj(self.lastBlock.blockHash), self.lastBlockHeight);
        
        // ignore orphans older than one week ago
        if (block.timestamp < [NSDate timeIntervalSinceReferenceDate] + NSTimeIntervalSince1970 - 7*24*60*60) return;
        
        // call getblocks, unless we already did with the previous block, or we're still downloading the chain
        if (self.lastBlockHeight >= peer.lastblock && ! uint256_eq(self.lastOrphan.blockHash, block.prevBlock)) {
            NSLog(@"%@:%d calling getblocks", peer.host, peer.port);
            [peer sendGetblocksMessageWithLocators:[self blockLocatorArray] andHashStop:UINT256_ZERO];
        }
        
        self.orphans[prevBlock] = block; // orphans are indexed by prevBlock instead of blockHash
        self.lastOrphan = block;
        return;
    }
    
    block.height = prev.height + 1;
    txTime = block.timestamp/2 + prev.timestamp/2;
    
    if ((block.height % 1000) == 0) { //free up some memory from time to time
        
        BRMerkleBlock *b = block;
        
        for (uint32_t i = 0; b && i < (DGW_PAST_BLOCKS_MAX + 50); i++) {
            b = self.blocks[uint256_obj(b.prevBlock)];
        }
        
        while (b) { // free up some memory
            b = self.blocks[uint256_obj(b.prevBlock)];
            if (b) [self.blocks removeObjectForKey:uint256_obj(b.prevBlock)];
        }
    }
    
    // verify block difficulty if block is past last checkpoint
    if ((block.height > (checkpoint_array[CHECKPOINT_COUNT - 1].height + DGW_PAST_BLOCKS_MAX)) &&
        ![block verifyDifficultyWithPreviousBlocks:self.blocks]) {
        NSLog(@"%@:%d relayed block with invalid difficulty height %d target %x, blockHash: %@", peer.host, peer.port,
              block.height,block.target, blockHash);
        [self peerMisbehavin:peer];
        return;
    }
    
    [self.checkpoints[@(block.height)] getValue:&checkpoint];
    
    // verify block chain checkpoints
    if (! uint256_is_zero(checkpoint) && ! uint256_eq(block.blockHash, checkpoint)) {
        NSLog(@"%@:%d relayed a block that differs from the checkpoint at height %d, blockHash: %@, expected: %@",
              peer.host, peer.port, block.height, blockHash, self.checkpoints[@(block.height)]);
        [self peerMisbehavin:peer];
        return;
    }
    
    if (uint256_eq(block.prevBlock, self.lastBlock.blockHash)) { // new block extends main chain
        if ((block.height % 500) == 0 || txHashes.count > 0 || block.height > peer.lastblock) {
            NSLog(@"adding block at height: %d, false positive rate: %f", block.height, self.fpRate);
        }
        
        self.blocks[blockHash] = block;
        self.lastBlock = block;
        [self setBlockHeight:block.height andTimestamp:txTime - NSTimeIntervalSince1970 forTxHashes:txHashes];
        if (peer == self.downloadPeer) self.lastRelayTime = [NSDate timeIntervalSinceReferenceDate];
        self.downloadPeer.currentBlockHeight = block.height;
        if (block.height == _estimatedBlockHeight) syncDone = YES;
    }
    else if (self.blocks[blockHash] != nil) { // we already have the block (or at least the header)
        if ((block.height % 500) == 0 || txHashes.count > 0 || block.height > peer.lastblock) {
            NSLog(@"%@:%d relayed existing block at height %d", peer.host, peer.port, block.height);
        }
        
        self.blocks[blockHash] = block;
        
        BRMerkleBlock *b = self.lastBlock;
        
        while (b && b.height > block.height) b = self.blocks[uint256_obj(b.prevBlock)]; // is block in main chain?
        
        if (uint256_eq(b.blockHash, block.blockHash)) { // if it's not on a fork, set block heights for its transactions
            [self setBlockHeight:block.height andTimestamp:txTime - NSTimeIntervalSince1970 forTxHashes:txHashes];
            if (block.height == self.lastBlockHeight) self.lastBlock = block;
        }
    }
    else { // new block is on a fork
        if (block.height <= checkpoint_array[CHECKPOINT_COUNT - 1].height) { // fork is older than last checkpoint
            NSLog(@"ignoring block on fork older than most recent checkpoint, fork height: %d, blockHash: %@",
                  block.height, blockHash);
            return;
        }
        
        // special case, if a new block is mined while we're rescanning the chain, mark as orphan til we're caught up
        if (self.lastBlockHeight < peer.lastblock && block.height > self.lastBlockHeight + 1) {
            NSLog(@"marking new block at height %d as orphan until rescan completes", block.height);
            self.orphans[prevBlock] = block;
            self.lastOrphan = block;
            return;
        }
        
        NSLog(@"chain fork to height %d", block.height);
        self.blocks[blockHash] = block;
        if (block.height <= self.lastBlockHeight) return; // if fork is shorter than main chain, ignore it for now
        
        NSMutableArray *txHashes = [NSMutableArray array];
        BRMerkleBlock *b = block, *b2 = self.lastBlock;
        
        while (b && b2 && ! uint256_eq(b.blockHash, b2.blockHash)) { // walk back to where the fork joins the main chain
            b = self.blocks[uint256_obj(b.prevBlock)];
            if (b.height < b2.height) b2 = self.blocks[uint256_obj(b2.prevBlock)];
        }
        
        NSLog(@"reorganizing chain from height %d, new height is %d", b.height, block.height);
        
        // mark transactions after the join point as unconfirmed
        for (BRTransaction *tx in [BRWalletManager sharedInstance].wallet.allTransactions) {
            if (tx.blockHeight <= b.height) break;
            [txHashes addObject:uint256_obj(tx.txHash)];
        }
        
        [self setBlockHeight:TX_UNCONFIRMED andTimestamp:0 forTxHashes:txHashes];
        b = block;
        
        while (b.height > b2.height) { // set transaction heights for new main chain
            [self setBlockHeight:b.height andTimestamp:txTime - NSTimeIntervalSince1970 forTxHashes:b.txHashes];
            b = self.blocks[uint256_obj(b.prevBlock)];
            txTime = b.timestamp/2 + ((BRMerkleBlock *)self.blocks[uint256_obj(b.prevBlock)]).timestamp/2;
        }
        
        self.lastBlock = block;
        if (block.height == _estimatedBlockHeight) syncDone = YES;
    }
    
    if (syncDone) { // chain download is complete
        self.syncStartHeight = 0;
        [[NSUserDefaults standardUserDefaults] setInteger:0 forKey:SYNC_STARTHEIGHT_KEY];
        [self saveBlocks];
        [self loadMempools];
    }
    
    if (block.height > _estimatedBlockHeight) {
        _estimatedBlockHeight = block.height;
        
        // notify that transaction confirmations may have changed
        dispatch_async(dispatch_get_main_queue(), ^{
            [[NSNotificationCenter defaultCenter] postNotificationName:BRPeerManagerTxStatusNotification object:nil];
        });
    }
    
    // check if the next block was received as an orphan
    if (block == self.lastBlock && self.orphans[blockHash]) {
        BRMerkleBlock *b = self.orphans[blockHash];
        
        [self.orphans removeObjectForKey:blockHash];
        [self peer:peer relayedBlock:b];
    }
}

- (void)peer:(BRPeer *)peer notfoundTxHashes:(NSArray *)txHashes andBlockHashes:(NSArray *)blockhashes
{
    for (NSValue *hash in txHashes) {
        [self.txRelays[hash] removeObject:peer];
        [self.txRequests[hash] removeObject:peer];
    }
}

- (void)peer:(BRPeer *)peer setFeePerKb:(uint64_t)feePerKb
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    uint64_t maxFeePerKb = 0, secondFeePerKb = 0;
    
    for (BRPeer *p in self.connectedPeers) { // find second highest fee rate
        if (p.feePerKb > maxFeePerKb) secondFeePerKb = maxFeePerKb, maxFeePerKb = p.feePerKb;
    }
    
    if (secondFeePerKb*2 > MIN_FEE_PER_KB && secondFeePerKb*2 <= MAX_FEE_PER_KB &&
        secondFeePerKb*2 > manager.wallet.feePerKb) {
        NSLog(@"increasing feePerKb to %llu based on feefilter messages from peers", secondFeePerKb*2);
        manager.wallet.feePerKb = secondFeePerKb*2;
    }
}

- (BRTransaction *)peer:(BRPeer *)peer requestedTransaction:(UInt256)txHash
{
    BRWalletManager *manager = [BRWalletManager sharedInstance];
    NSValue *hash = uint256_obj(txHash);
    BRTransaction *tx = self.publishedTx[hash];
    void (^callback)(NSError *error) = self.publishedCallback[hash];
    NSError *error = nil;
    
    if (! self.txRelays[hash]) self.txRelays[hash] = [NSMutableSet set];
    [self.txRelays[hash] addObject:peer];
    [self.nonFpTx addObject:hash];
    [self.publishedCallback removeObjectForKey:hash];
    
    if (callback && ! [manager.wallet transactionIsValid:tx]) {
        [self.publishedTx removeObjectForKey:hash];
        error = [NSError errorWithDomain:@"GroestlWallet" code:401
                                userInfo:@{NSLocalizedDescriptionKey:NSLocalizedString(@"double spend", nil)}];
    }
    else if (tx && ! [manager.wallet transactionForHash:txHash] && [manager.wallet registerTransaction:tx]) {
        [[BRTransactionEntity context] performBlock:^{
            [BRTransactionEntity saveContext]; // persist transactions to core data
        }];
    }
    
    dispatch_async(dispatch_get_main_queue(), ^{
        [NSObject cancelPreviousPerformRequestsWithTarget:self selector:@selector(txTimeout:) object:hash];
        if (callback) callback(error);
    });
    
    //    [peer sendPingMessageWithPongHandler:^(BOOL success) { // check if peer will relay the transaction back
    //        if (! success) return;
    //        
    //        if (! [self.txRequests[hash] containsObject:peer]) {
    //            if (! self.txRequests[hash]) self.txRequests[hash] = [NSMutableSet set];
    //            [self.txRequests[hash] addObject:peer];
    //            [peer sendGetdataMessageWithTxHashes:@[hash] andBlockHashes:nil];
    //        }
    //    }];
    
    return tx;
}

// MARK: - UIAlertViewDelegate

- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == alertView.cancelButtonIndex) return;
    [self rescan];
}

@end
